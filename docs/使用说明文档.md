# qstock é‡åŒ–æŠ•ç ”åˆ†æåº“ - å®Œæ•´ä½¿ç”¨è¯´æ˜æ–‡æ¡£

## ğŸ“š ç›®å½•

- [ç®€ä»‹](#ç®€ä»‹)
- [å®‰è£…ä¸ç¯å¢ƒé…ç½®](#å®‰è£…ä¸ç¯å¢ƒé…ç½®)
- [æ•°æ®æ¨¡å— (data)](#æ•°æ®æ¨¡å—-data)
  - [è¡Œæƒ…äº¤æ˜“æ•°æ®](#è¡Œæƒ…äº¤æ˜“æ•°æ®)
  - [åŸºæœ¬é¢æ•°æ®](#åŸºæœ¬é¢æ•°æ®)
  - [èµ„é‡‘æµæ•°æ®](#èµ„é‡‘æµæ•°æ®)
  - [è¡Œä¸šæ¦‚å¿µæ•°æ®](#è¡Œä¸šæ¦‚å¿µæ•°æ®)
  - [å®è§‚ç»æµæ•°æ®](#å®è§‚ç»æµæ•°æ®)
  - [æ–°é—»èµ„è®¯æ•°æ®](#æ–°é—»èµ„è®¯æ•°æ®)
  - [é—®è´¢æ•°æ®](#é—®è´¢æ•°æ®)
- [å¯è§†åŒ–æ¨¡å— (plot)](#å¯è§†åŒ–æ¨¡å—-plot)
- [é€‰è‚¡æ¨¡å— (stock)](#é€‰è‚¡æ¨¡å—-stock)
- [å›æµ‹æ¨¡å— (backtest)](#å›æµ‹æ¨¡å—-backtest)
- [å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹](#å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)

---

## ç®€ä»‹

**qstock** æ˜¯ç”±"Pythoné‡‘èé‡åŒ–"å…¬ä¼—å·å¼€å‘çš„ä¸ªäººé‡åŒ–æŠ•ç ”åˆ†æå¼€æºåº“ï¼Œè‡´åŠ›äºä¸ºç”¨æˆ·æä¾›ç®€æ´è§„æ•´çš„é‡‘èå¸‚åœºæ•°æ®æ¥å£ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **æ•°æ®æ¥æº**ï¼šä¸œæ–¹è´¢å¯Œç½‘ã€åŒèŠ±é¡ºã€æ–°æµªè´¢ç»ç­‰å…¬å¼€æ•°æ®
- âœ… **å››å¤§æ¨¡å—**ï¼šæ•°æ®è·å–ã€å¯è§†åŒ–ã€é€‰è‚¡ã€é‡åŒ–å›æµ‹
- âœ… **å…è´¹å¼€æº**ï¼špypiå®˜ç½‘å’ŒGitHubå‘å¸ƒ
- âœ… **ç®€å•æ˜“ç”¨**ï¼šå‡½æ•°å¼æ¥å£ï¼Œé€‚åˆåˆå­¦è€…

### ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**ï¼š1.3.8
- **å®‰è£…å‘½ä»¤**ï¼š
  ```bash
  pip install qstock
  ```
- **æ›´æ–°å‘½ä»¤**ï¼š
  ```bash
  pip install --upgrade qstock
  ```

### å¯¼å…¥åº“

```python
import qstock as qs
```

---

## å®‰è£…ä¸ç¯å¢ƒé…ç½®

### åŸºç¡€å®‰è£…

```bash
pip install qstock
```

### é—®è´¢åŠŸèƒ½é…ç½®ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨é—®è´¢(wencai)åŠŸèƒ½ï¼Œéœ€è¦é¢å¤–é…ç½®ï¼š

1. **å‡çº§ pywencai**
   ```bash
   pip install --upgrade pywencai
   ```

2. **å®‰è£… Node.js**
   - ä¸‹è½½åœ°å€ï¼šhttps://nodejs.org/
   - å®‰è£…ååœ¨ Node.js å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š
     ```bash
     npm install jsdom
     ```

### ä¾èµ–åŒ…

- pandas
- numpy
- requests
- BeautifulSoup4
- tqdm
- multitasking
- func_timeout
- plotly
- pyecharts
- matplotlib

---

## æ•°æ®æ¨¡å— (data)

æ•°æ®æ¨¡å—æ˜¯qstockçš„æ ¸å¿ƒï¼Œæä¾›ä¸°å¯Œçš„é‡‘èæ•°æ®æ¥å£ã€‚

---

### è¡Œæƒ…äº¤æ˜“æ•°æ®

#### 1. å®æ—¶è¡Œæƒ…æ•°æ®

**å‡½æ•°åç§°**ï¼š`realtime_data(market='æ²ªæ·±A', code=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æŒ‡å®šå¸‚åœºæ‰€æœ‰æ ‡çš„æˆ–å•ä¸ª/å¤šä¸ªè¯åˆ¸æœ€æ–°è¡Œæƒ…æŒ‡æ ‡

**å‚æ•°è¯´æ˜**ï¼š
- `market`ï¼šå¸‚åœºåç§°ï¼Œé»˜è®¤'æ²ªæ·±A'
  - å¯é€‰å€¼ï¼š'æ²ªæ·±äº¬A'ã€'æ²ªæ·±A'ã€'æ²ªA'ã€'æ·±A'ã€'åŒ—A'ã€'å¯è½¬å€º'ã€'æœŸè´§'ã€'åˆ›ä¸šæ¿'ã€'ç¾è‚¡'ã€'æ¸¯è‚¡'ã€'ä¸­æ¦‚è‚¡'ã€'æ–°è‚¡'ã€'ç§‘åˆ›æ¿'ã€'æ²ªè‚¡é€š'ã€'æ·±è‚¡é€š'ã€'è¡Œä¸šæ¿å—'ã€'æ¦‚å¿µæ¿å—'ã€'æ²ªæ·±æŒ‡æ•°'ã€'ä¸Šè¯æŒ‡æ•°'ã€'æ·±è¯æŒ‡æ•°'ã€'ETF'ã€'LOF'
- `code`ï¼šè¯åˆ¸ä»£ç æˆ–åç§°ï¼Œå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ä¸²æˆ–åˆ—è¡¨
  - ç¤ºä¾‹ï¼š`code='ä¸­å›½å¹³å®‰'` æˆ– `code='000001'` æˆ– `code=['ä¸­å›½å¹³å®‰','æ™“ç¨‹ç§‘æŠ€','ä¸œæ–¹è´¢å¯Œ']`

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€åç§°ã€æœ€æ–°ä»·ã€æ¶¨å¹…ã€æ¶¨è·Œé¢ã€æœ€é«˜ã€æœ€ä½ã€ä»Šå¼€ã€æ˜¨æ”¶
- æˆäº¤é‡ã€æˆäº¤é¢ã€æ¢æ‰‹ç‡ã€é‡æ¯”ã€å¸‚ç›ˆç‡ã€æ€»å¸‚å€¼ã€æµé€šå¸‚å€¼ã€æ—¶é—´

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è·å–æ²ªæ·±Aè‚¡æ‰€æœ‰è‚¡ç¥¨å®æ—¶è¡Œæƒ…
df = qs.realtime_data()
df.head()

# è·å–æœŸè´§å®æ—¶è¡Œæƒ…
df = qs.realtime_data('æœŸè´§')

# è·å–æ¦‚å¿µæ¿å—å®æ—¶è¡Œæƒ…
df = qs.realtime_data('æ¦‚å¿µæ¿å—')

# è·å–å•åªæˆ–å¤šåªè‚¡ç¥¨å®æ—¶è¡Œæƒ…
df = qs.realtime_data(code=['ä¸­å›½å¹³å®‰','300684','é”‚ç”µæ± ETF','BK0679','ä¸Šè¯æŒ‡æ•°'])
```

**æ¨èç”¨æ³•**ï¼š
- ç”¨äºå®æ—¶ç›‘æ§å¸‚åœºè¡Œæƒ…
- æ‰¹é‡è·å–å¤šåªè‚¡ç¥¨æ•°æ®æ—¶ï¼Œå»ºè®®ä½¿ç”¨åˆ—è¡¨å½¢å¼ä¼ å…¥codeå‚æ•°

---

#### 2. æ—¥å†…æˆäº¤æ•°æ®

**å‡½æ•°åç§°**ï¼š`intraday_data(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–è‚¡ç¥¨ã€æœŸè´§ã€å€ºåˆ¸çš„æœ€æ–°äº¤æ˜“æ—¥æ—¥å†…æˆäº¤æ˜ç»†

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ã€å€ºåˆ¸ã€æœŸè´§ä»£ç æˆ–ç®€ç§°

**è¿”å›å­—æ®µ**ï¼š
- åç§°ã€ä»£ç ã€æ—¶é—´ã€æ˜¨æ”¶ã€æˆäº¤ä»·ã€æˆäº¤é‡ã€å•æ•°

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è‚¡ç¥¨æ—¥å†…äº¤æ˜“æ•°æ®
df = qs.intraday_data('ä¸­å›½å¹³å®‰')
df.head()

# åŸºé‡‘æ—¥å†…äº¤æ˜“æ•°æ®
df = qs.intraday_data('æœ‰è‰²50ETF')
```

---

#### 3. ä¸ªè‚¡å®æ—¶å¿«ç…§

**å‡½æ•°åç§°**ï¼š`stock_snapshot(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ²ªæ·±å¸‚åœºè‚¡ç¥¨æœ€æ–°è¡Œæƒ…å¿«ç…§ï¼ŒåŒ…å«è¯¦ç»†çš„ä¹°å–ç›˜å£ä¿¡æ¯

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–åç§°

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€åç§°ã€æ—¶é—´ã€æ¶¨è·Œé¢ã€æ¶¨è·Œå¹…ã€æœ€æ–°ä»·ã€æ˜¨æ”¶ã€ä»Šå¼€
- å¼€ç›˜ã€æœ€é«˜ã€æœ€ä½ã€å‡ä»·ã€æ¶¨åœä»·ã€è·Œåœä»·ã€æ¢æ‰‹ç‡
- æˆäº¤é‡ã€æˆäº¤é¢
- å–1-5ä»·ã€å–1-5æ•°é‡ã€ä¹°1-5ä»·ã€ä¹°1-5æ•°é‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_snapshot('ä¸­å›½å¹³å®‰')
```

---

#### 4. å®æ—¶ç›˜å£å¼‚åŠ¨æ•°æ®

**å‡½æ•°åç§°**ï¼š`realtime_change(flag=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–äº¤æ˜“æ—¥å®æ—¶ç›˜å£å¼‚åŠ¨æ•°æ®ï¼Œç›¸å½“äºç›¯ç›˜å°ç²¾çµ

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šç›˜å£å¼‚åŠ¨ç±»å‹ï¼Œé»˜è®¤è¿”å›å…¨éƒ¨ç±»å‹
  - å¯é€‰å€¼ï¼ˆå­—ç¬¦ä¸²æˆ–æ•°å­—1-22ï¼‰ï¼š
    - 'ç«ç®­å‘å°„'(1)ã€'å¿«é€Ÿåå¼¹'(2)ã€'åŠ é€Ÿä¸‹è·Œ'(3)ã€'é«˜å°è·³æ°´'(4)
    - 'å¤§ç¬”ä¹°å…¥'(5)ã€'å¤§ç¬”å–å‡º'(6)ã€'å°æ¶¨åœæ¿'(7)ã€'å°è·Œåœæ¿'(8)
    - 'æ‰“å¼€è·Œåœæ¿'(9)ã€'æ‰“å¼€æ¶¨åœæ¿'(10)ã€'æœ‰å¤§ä¹°ç›˜'(11)ã€'æœ‰å¤§å–ç›˜'(12)
    - 'ç«ä»·ä¸Šæ¶¨'(13)ã€'ç«ä»·ä¸‹è·Œ'(14)ã€'é«˜å¼€5æ—¥çº¿'(15)ã€'ä½å¼€5æ—¥çº¿'(16)
    - 'å‘ä¸Šç¼ºå£'(17)ã€'å‘ä¸‹ç¼ºå£'(18)ã€'60æ—¥æ–°é«˜'(19)ã€'60æ—¥æ–°ä½'(20)
    - '60æ—¥å¤§å¹…ä¸Šæ¶¨'(21)ã€'60æ—¥å¤§å¹…ä¸‹è·Œ'(22)

**è¿”å›å­—æ®µ**ï¼š
- æ—¶é—´ã€ä»£ç ã€åç§°ã€æ¿å—ã€ç›¸å…³ä¿¡æ¯

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è·å–60æ—¥æ–°é«˜çš„è‚¡ç¥¨
df = qs.realtime_change('60æ—¥æ–°é«˜')
df.head()

# ä½¿ç”¨æ•°å­—ä»£æ›¿
df = qs.realtime_change(1)  # ç«ç®­å‘å°„
```

---

#### 5. å†å²Kçº¿æ•°æ®

**å‡½æ•°åç§°**ï¼š`get_data(code_list, start='19000101', end=None, freq='d', fqt=1)`

**åŠŸèƒ½æè¿°**ï¼šè·å–è‚¡ç¥¨ã€æŒ‡æ•°ã€å€ºåˆ¸ã€æœŸè´§ã€åŸºé‡‘ç­‰å†å²Kçº¿è¡Œæƒ…

**å‚æ•°è¯´æ˜**ï¼š
- `code_list`ï¼šä»£ç æˆ–ç®€ç§°ï¼Œå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ä¸²æˆ–åˆ—è¡¨
- `start`ï¼šèµ·å§‹æ—¥æœŸï¼Œæ ¼å¼'YYYYMMDD'æˆ–'YYYY-MM-DD'
- `end`ï¼šç»“æŸæ—¥æœŸï¼Œé»˜è®¤ä¸ºæœ€æ–°äº¤æ˜“æ—¥
- `freq`ï¼šæ—¶é—´é¢‘ç‡
  - `1`ï¼š1åˆ†é’Ÿï¼ˆä»…æœ€è¿‘5ä¸ªäº¤æ˜“æ—¥ï¼‰
  - `5`ï¼š5åˆ†é’Ÿ
  - `15`ï¼š15åˆ†é’Ÿ
  - `30`ï¼š30åˆ†é’Ÿ
  - `60`ï¼š60åˆ†é’Ÿ
  - `101`æˆ–`'d'`æˆ–`'D'`ï¼šæ—¥çº¿ï¼ˆé»˜è®¤ï¼‰
  - `102`æˆ–`'w'`æˆ–`'W'`ï¼šå‘¨çº¿
  - `103`æˆ–`'m'`æˆ–`'M'`ï¼šæœˆçº¿
- `fqt`ï¼šå¤æƒç±»å‹
  - `0`ï¼šä¸å¤æƒ
  - `1`ï¼šå‰å¤æƒï¼ˆé»˜è®¤ï¼‰
  - `2`ï¼šåå¤æƒ

**è¿”å›å­—æ®µ**ï¼š
- dateï¼ˆç´¢å¼•ï¼‰ã€nameã€codeã€openã€highã€lowã€closeã€volumeã€turnoverã€turnover_rate

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è·å–ä¸ªè‚¡å†å²æ•°æ®ï¼ˆé»˜è®¤æ—¥é¢‘ã€å‰å¤æƒã€æ‰€æœ‰å†å²æ•°æ®ï¼‰
df = qs.get_data('601318')
df.tail()

# è·å–ä¸­å›½å¹³å®‰2022å¹´9æœˆ28æ—¥è‡³ä»Šçš„5åˆ†é’Ÿæ•°æ®
df = qs.get_data('ä¸­å›½å¹³å®‰', start='20220928', freq=5)

# è·å–ç¾è‚¡æ•°æ®
df = qs.get_data('AAPL')

# è·å–æœŸè´§æ•°æ®
df = qs.get_data('æ£•æ¦ˆæ²¹2210')

# è·å–æŒ‡æ•°æ•°æ®
code_list = ['sh','sz','cyb','zxb','hs300','sz50','zz500']
df = qs.get_data(code_list)

# è·å–å…¨çƒæŒ‡æ•°
global_indexs = ['é“ç¼æ–¯','æ ‡æ™®500','çº³æ–¯è¾¾å…‹','æ’ç”ŸæŒ‡æ•°','è‹±å›½å¯Œæ—¶']
df = qs.get_data(global_indexs)
```

**æ³¨æ„äº‹é¡¹**ï¼š
- 1åˆ†é’Ÿæ•°æ®ä»…èƒ½è·å–æœ€è¿‘5ä¸ªäº¤æ˜“æ—¥
- æŒ‡æ•°ä»£ç éœ€ä½¿ç”¨ç®€ç§°æˆ–æ‹¼éŸ³ç¼©å†™ï¼Œå¦‚'sh'ä»£è¡¨'ä¸Šè¯æŒ‡æ•°'

---

#### 6. è·å–ä»·æ ¼æ•°æ®

**å‡½æ•°åç§°**ï¼š`get_price(code_list, start='19000101', end=None, freq='d', fqt=1)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å•åªæˆ–å¤šåªè¯åˆ¸çš„æ”¶ç›˜ä»·æ ¼DataFrameï¼ˆå®½è¡¨æ ¼å¼ï¼‰

**å‚æ•°è¯´æ˜**ï¼šä¸`get_data`ç›¸åŒ

**è¿”å›æ ¼å¼**ï¼šæ—¥æœŸä¸ºç´¢å¼•ï¼Œæ¯åªè‚¡ç¥¨çš„æ”¶ç›˜ä»·ä¸ºä¸€åˆ—

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
code_list = ['ä¸­å›½å¹³å®‰','300684','é”‚ç”µæ± ETF','BK0679','ä¸Šè¯æŒ‡æ•°']
df = qs.get_price(code_list)
df.tail()
```

---

#### 7. è‚¡ç¥¨é¾™è™æ¦œæ•°æ®

**å‡½æ•°åç§°**ï¼š`stock_billboard(start=None, end=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–è‚¡ç¥¨é¾™è™æ¦œæ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `start`ï¼šèµ·å§‹æ—¥æœŸï¼Œé»˜è®¤ä¸ºNoneè¡¨ç¤ºæœ€æ–°
- `end`ï¼šç»“æŸæ—¥æœŸï¼Œé»˜è®¤ä¸ºNoneè¡¨ç¤ºæœ€æ–°
- æ—¥æœŸæ ¼å¼ï¼š'2021-08-21'æˆ–'20210821'

**è¿”å›å­—æ®µ**ï¼š
- è‚¡ç¥¨ä»£ç ã€è‚¡ç¥¨åç§°ã€ä¸Šæ¦œæ—¥æœŸã€æ”¶ç›˜ä»·ã€æ¶¨è·Œå¹…ã€æ¢æ‰‹ç‡
- é¾™è™æ¦œå‡€ä¹°é¢ã€æµé€šå¸‚å€¼ã€ä¸Šæ¦œåŸå› ã€è§£è¯»

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_billboard('20220901','20221011')
```

---

#### 8. æŒ‡æ•°æˆåˆ†è‚¡

**å‡½æ•°åç§°**ï¼š`index_member(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å¸¸è§æŒ‡æ•°çš„æˆåˆ†è‚¡

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šæŒ‡æ•°åç§°æˆ–ä»£ç 
  - æ”¯æŒï¼š'sz50'(ä¸Šè¯50)ã€'hs300'(æ²ªæ·±300)ã€'zz500'(ä¸­è¯500)ç­‰

**è¿”å›å­—æ®µ**ï¼š
- æŒ‡æ•°ä»£ç ã€æŒ‡æ•°åç§°ã€è‚¡ç¥¨ä»£ç ã€è‚¡ç¥¨åç§°ã€è‚¡ç¥¨æƒé‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä¸Šè¯50æˆä»½è‚¡
df = qs.index_member('sz50')

# æ²ªæ·±300æˆåˆ†è‚¡
df = qs.index_member('hs300')
```

---

### åŸºæœ¬é¢æ•°æ®

#### 1. è‚¡ä¸œæŒè‚¡ä¿¡æ¯

##### 1.1 å‰åå¤§è‚¡ä¸œä¿¡æ¯

**å‡½æ•°åç§°**ï¼š`stock_holder_top10(code, n=2)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ²ªæ·±å¸‚åœºæŒ‡å®šè‚¡ç¥¨å‰åå¤§æµé€šè‚¡ä¸œä¿¡æ¯

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–åç§°
- `n`ï¼šæœ€æ–°nä¸ªå­£åº¦çš„æ•°æ®ï¼Œé»˜è®¤2

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€æ—¥æœŸã€è‚¡ä¸œåç§°ã€æŒè‚¡æ•°(äº¿)ã€æŒè‚¡æ¯”ä¾‹(%)ã€å¢å‡ã€å˜åŠ¨ç‡(%)

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_holder_top10('ä¸­å›½å¹³å®‰', n=2)
```

##### 1.2 è‚¡ä¸œæ•°é‡å˜åŒ–

**å‡½æ•°åç§°**ï¼š`stock_holder_num(date=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ²ªæ·±Aè‚¡å¸‚åœºå…¬å¼€çš„è‚¡ä¸œæ•°ç›®å˜åŒ–æƒ…å†µ

**å‚æ•°è¯´æ˜**ï¼š
- `date`ï¼šæŠ¥å‘ŠæœŸï¼Œé»˜è®¤æœ€æ–°
  - æ ¼å¼ï¼š'2022-03-31'ã€'2022-06-30'ã€'2022-09-30'ã€'2022-12-31'

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€åç§°ã€æˆªæ­¢æ—¥ã€è‚¡ä¸œäººæ•°ã€å¢å‡(%)ã€è¾ƒä¸ŠæœŸå˜åŒ–
- æˆ·å‡æŒè‚¡å¸‚å€¼ã€æˆ·å‡æŒè‚¡æ•°é‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_holder_num('20220930')
```

##### 1.3 å¤§è‚¡ä¸œå¢å‡æŒæ˜ç»†

**å‡½æ•°åç§°**ï¼š`stock_holder_change()`

**åŠŸèƒ½æè¿°**ï¼šè·å–å¤§è‚¡ä¸œå¢å‡æŒå˜åŠ¨æ˜ç»†

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€åç§°ã€æœ€æ–°ä»·ã€æ¶¨è·Œå¹…ã€è‚¡ä¸œåç§°ã€å¢å‡
- å˜åŠ¨æ•°é‡ã€å˜åŠ¨å æ€»è‚¡æœ¬æ¯”ä¾‹ã€å˜åŠ¨å æµé€šè‚¡æ¯”ä¾‹
- å˜åŠ¨åæŒè‚¡æ€»æ•°ã€å˜åŠ¨åå æ€»è‚¡æœ¬æ¯”ä¾‹ã€å˜åŠ¨åæŒæµé€šè‚¡æ•°
- å˜åŠ¨åå æµé€šè‚¡æ¯”ä¾‹ã€å¼€å§‹æ—¥ã€æˆªæ­¢æ—¥ã€å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_holder_change()
df.head()
```

##### 1.4 æœºæ„æŒè‚¡

**å‡½æ•°åç§°**ï¼š`institute_hold(quarter="20221")`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ–°æµªè´¢ç»æœºæ„æŒè‚¡ä¸€è§ˆè¡¨

**å‚æ•°è¯´æ˜**ï¼š
- `quarter`ï¼šå­£åº¦
  - æ ¼å¼ï¼š'20221'è¡¨ç¤º2022å¹´ä¸€å­£åº¦ï¼Œ'20193'è¡¨ç¤º2019å¹´ä¸‰å­£åº¦

**è¿”å›å­—æ®µ**ï¼š
- è¯åˆ¸ä»£ç ã€ç®€ç§°ã€æœºæ„æ•°ã€æœºæ„æ•°å˜åŒ–ã€æŒè‚¡æ¯”ä¾‹
- æŒè‚¡æ¯”ä¾‹å¢å¹…ã€å æµé€šè‚¡æ¯”ä¾‹ã€å æµé€šè‚¡æ¯”ä¾‹å¢å¹…

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.institute_hold('20222')  # 2022å¹´äºŒå­£åº¦
```

---

#### 2. ä¸»è¥ä¸šåŠ¡æ„æˆ

**å‡½æ•°åç§°**ï¼š`main_business(code="000001")`

**åŠŸèƒ½æè¿°**ï¼šè·å–å…¬å¸ä¸»è¥ä¸šåŠ¡æ„æˆ

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–ç®€ç§°

**è¿”å›å­—æ®µ**ï¼š
- æŠ¥å‘ŠæœŸã€åˆ†ç±»æ–¹å‘ã€åˆ†ç±»
- è¥ä¸šæ”¶å…¥(ä¸‡)ã€è¥æ”¶åŒæ¯”ã€å ä¸»è¥æ”¶å…¥æ¯”
- è¥ä¸šæˆæœ¬(ä¸‡)ã€è¥ä¸šæˆæœ¬åŒæ¯”ã€å ä¸»è¥æˆæœ¬æ¯”
- æ¯›åˆ©ç‡ã€æ¯›åˆ©ç‡åŒæ¯”

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.main_business('ä¸°å…ƒè‚¡ä»½')
```

---

#### 3. è´¢åŠ¡æŠ¥è¡¨

**å‡½æ•°åç§°**ï¼š`financial_statement(flag='ä¸šç»©æŠ¥è¡¨', date=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å„ç±»è´¢åŠ¡æŠ¥è¡¨æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šæŠ¥è¡¨ç±»å‹
  - `'ä¸šç»©æŠ¥è¡¨'`æˆ–`'yjbb'`ï¼šå¹´æŠ¥å­£æŠ¥è´¢åŠ¡æŒ‡æ ‡ï¼ˆé»˜è®¤ï¼‰
  - `'ä¸šç»©å¿«æŠ¥'`æˆ–`'yjkb'`ï¼šæœ€æ–°ä¸šç»©å¿«æŠ¥
  - `'ä¸šç»©é¢„å‘Š'`æˆ–`'yjyg'`ï¼šæœ€æ–°ä¸šç»©é¢„å‘Š
  - `'èµ„äº§è´Ÿå€ºè¡¨'`æˆ–`'zcfz'`ï¼šæœ€æ–°èµ„äº§è´Ÿå€ºæŒ‡æ ‡
  - `'åˆ©æ¶¦è¡¨'`æˆ–`'lrb'`ï¼šæœ€æ–°åˆ©æ¶¦è¡¨æŒ‡æ ‡
  - `'ç°é‡‘æµé‡è¡¨'`æˆ–`'xjll'`ï¼šæœ€æ–°ç°é‡‘æµé‡è¡¨æŒ‡æ ‡
- `date`ï¼šæŠ¥è¡¨æ—¥æœŸï¼Œé»˜è®¤å½“å‰æœ€æ–°å­£æŠ¥
  - æ ¼å¼ï¼š'20220630'æˆ–'20220331'

##### 3.1 ä¸šç»©æŠ¥è¡¨

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€ç®€ç§°ã€æ¯è‚¡æ”¶ç›Šã€è¥ä¸šæ”¶å…¥ã€è¥ä¸šæ”¶å…¥åŒæ¯”ã€è¥ä¸šæ”¶å…¥å­£åº¦ç¯æ¯”
- å‡€åˆ©æ¶¦ã€å‡€åˆ©æ¶¦åŒæ¯”ã€å‡€åˆ©æ¶¦å­£åº¦ç¯æ¯”ã€æ¯è‚¡å‡€èµ„äº§ã€å‡€èµ„äº§æ”¶ç›Šç‡
- æ¯è‚¡ç»è¥ç°é‡‘æµé‡ã€é”€å”®æ¯›åˆ©ç‡ã€è¡Œä¸šã€æœ€æ–°å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.financial_statement('ä¸šç»©æŠ¥è¡¨', date='20220930')
```

##### 3.2 ä¸šç»©é¢„å‘Š

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€ç®€ç§°ã€é¢„æµ‹æŒ‡æ ‡ã€ä¸šç»©å˜åŠ¨ã€é¢„æµ‹æ•°å€¼ã€å˜åŠ¨å¹…åº¦
- å˜åŠ¨åŸå› ã€é¢„å‘Šç±»å‹ã€ä¸Šå¹´åŒæœŸã€å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.financial_statement('yjyg')
```

##### 3.3 èµ„äº§è´Ÿå€ºè¡¨

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€ç®€ç§°ã€è´§å¸èµ„é‡‘ã€åº”æ”¶è´¦æ¬¾ã€å­˜è´§ã€æ€»èµ„äº§ã€æ€»èµ„äº§åŒæ¯”
- åº”ä»˜è´¦æ¬¾ã€é¢„æ”¶è´¦æ¬¾ã€æ€»è´Ÿå€ºã€æ€»è´Ÿå€ºåŒæ¯”ã€èµ„äº§è´Ÿå€ºç‡
- è‚¡ä¸œæƒç›Šã€å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.financial_statement('èµ„äº§è´Ÿå€ºè¡¨')
```

##### 3.4 åˆ©æ¶¦è¡¨

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€ç®€ç§°ã€å‡€åˆ©æ¶¦ã€å‡€åˆ©æ¶¦åŒæ¯”ã€è¥ä¸šæ€»æ”¶å…¥ã€è¥ä¸šæ€»æ”¶å…¥åŒæ¯”
- è¥ä¸šæ”¯å‡ºã€é”€å”®è´¹ç”¨ã€ç®¡ç†è´¹ç”¨ã€è´¢åŠ¡è´¹ç”¨ã€è¥ä¸šæ€»æ”¯å‡º
- è¥ä¸šåˆ©æ¶¦ã€åˆ©æ¶¦æ€»é¢ã€å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.financial_statement('åˆ©æ¶¦è¡¨')
```

##### 3.5 ç°é‡‘æµé‡è¡¨

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€ç®€ç§°ã€å‡€ç°é‡‘æµã€å‡€ç°é‡‘æµåŒæ¯”å¢é•¿
- ç»è¥æ€§ç°é‡‘æµé‡å‡€é¢ã€ç»è¥æ€§å‡€ç°é‡‘æµå æ¯”
- æŠ•èµ„æ€§ç°é‡‘æµé‡å‡€é¢ã€æŠ•èµ„æ€§å‡€ç°é‡‘æµå æ¯”
- èèµ„æ€§ç°é‡‘æµé‡å‡€é¢ã€èèµ„æ€§å‡€ç°é‡‘æµå æ¯”ã€å…¬å‘Šæ—¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.financial_statement('ç°é‡‘æµé‡è¡¨')
```

---

#### 4. è´¢åŠ¡æŒ‡æ ‡

##### 4.1 ä¸ªè‚¡åŸºæœ¬è´¢åŠ¡æŒ‡æ ‡

**å‡½æ•°åç§°**ï¼š`stock_basics(code_list)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å•åªæˆ–å¤šåªè‚¡ç¥¨æœ€æ–°çš„åŸºæœ¬è´¢åŠ¡æŒ‡æ ‡

**å‚æ•°è¯´æ˜**ï¼š
- `code_list`ï¼šä»£ç æˆ–ç®€ç§°ï¼Œå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ä¸²æˆ–åˆ—è¡¨

**è¿”å›å­—æ®µ**ï¼š
- ä»£ç ã€åç§°ã€å‡€åˆ©æ¶¦ã€æ€»å¸‚å€¼ã€æµé€šå¸‚å€¼ã€æ‰€å¤„è¡Œä¸š
- å¸‚ç›ˆç‡ã€å¸‚å‡€ç‡ã€ROEã€æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
code_list = ['300139','ä¸­å›½å¹³å®‰','è¥¿éƒ¨å»ºè®¾','è´µå·èŒ…å°','ä¸°å…ƒè‚¡ä»½']
df = qs.stock_basics(code_list)
```

##### 4.2 ä¸ªè‚¡è¯¦ç»†è´¢åŠ¡æŒ‡æ ‡

**å‡½æ•°åç§°**ï¼š`stock_indicator(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–ä¸ªè‚¡å†å²æŠ¥å‘ŠæœŸæ‰€æœ‰è´¢åŠ¡åˆ†ææŒ‡æ ‡

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–ç®€ç§°

**è¿”å›å­—æ®µ**ï¼š
åŒ…å«æ¯è‚¡æŒ‡æ ‡ã€ç›ˆåˆ©èƒ½åŠ›ã€æˆé•¿èƒ½åŠ›ã€è¥è¿èƒ½åŠ›ã€å¿å€ºåŠèµ„æœ¬ç»“æ„ã€ç°é‡‘æµé‡ã€å…¶ä»–æŒ‡æ ‡ç­‰å¤šä¸ªç±»åˆ«çš„è¯¦ç»†æŒ‡æ ‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.stock_indicator('ä¸­å›½å¹³å®‰')
```

##### 4.3 æ¯è‚¡æ”¶ç›Šé¢„æµ‹

**å‡½æ•°åç§°**ï¼š`eps_forecast()`

**åŠŸèƒ½æè¿°**ï¼šè·å–å¸‚åœºåˆ†æå¸ˆå¯¹å„è‚¡ç¥¨çš„æ¯è‚¡æ”¶ç›Šé¢„æµ‹

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.eps_forecast()
```

---

### èµ„é‡‘æµæ•°æ®

#### 1. ä¸ªè‚¡èµ„é‡‘æµ

##### 1.1 æ—¥å†…èµ„é‡‘æµæ•°æ®

**å‡½æ•°åç§°**ï¼š`intraday_money(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å•åªè‚¡ç¥¨æœ€æ–°äº¤æ˜“æ—¥çš„æ—¥å†…åˆ†é’Ÿçº§èµ„é‡‘æµå…¥æµå‡ºæ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ã€å€ºåˆ¸ä»£ç æˆ–åç§°

**è¿”å›å­—æ®µ**ï¼š
- åç§°ã€ä»£ç ã€æ—¶é—´ã€ä¸»åŠ›å‡€æµå…¥ã€å°å•å‡€æµå…¥ã€ä¸­å•å‡€æµå…¥
- å¤§å•å‡€æµå…¥ã€è¶…å¤§å•å‡€æµå…¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# æ³¨æ„ï¼šéœ€è¦åœ¨äº¤æ˜“æ—¥äº¤æ˜“æ—¶æ®µæ‰èƒ½è·å–åˆ°æ•°æ®
df = qs.intraday_money('ä¸­å›½å¹³å®‰')
```

##### 1.2 å†å²èµ„é‡‘æµæ•°æ®

**å‡½æ•°åç§°**ï¼š`hist_money(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–è‚¡ç¥¨ã€å€ºåˆ¸ã€æœŸè´§çš„å†å²èµ„é‡‘æµå…¥æµå‡ºæ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ã€å€ºåˆ¸ã€æœŸè´§ä»£ç æˆ–åç§°

**è¿”å›å­—æ®µ**ï¼š
- åç§°ã€ä»£ç ã€æ—¥æœŸã€ä¸»åŠ›å‡€æµå…¥ã€å°å•å‡€æµå…¥ã€ä¸­å•å‡€æµå…¥
- å¤§å•å‡€æµå…¥ã€è¶…å¤§å•å‡€æµå…¥ã€ä¸»åŠ›å‡€æµå…¥å æ¯”ã€å°å•æµå…¥å‡€å æ¯”
- ä¸­å•æµå…¥å‡€å æ¯”ã€å¤§å•æµå…¥å‡€å æ¯”ã€è¶…å¤§å•æµå…¥å‡€å æ¯”
- æ”¶ç›˜ä»·ã€æ¶¨è·Œå¹…

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.hist_money('ä¸­å›½å¹³å®‰')
df.tail()
```

##### 1.3 ä¸ªè‚¡Næ—¥èµ„é‡‘æµ

**å‡½æ•°åç§°**ï¼š`stock_money(code, ndays=[3, 5, 10, 20])`

**åŠŸèƒ½æè¿°**ï¼šè·å–ä¸ªè‚¡æŒ‡å®šå‘¨æœŸçš„ç´¯è®¡èµ„é‡‘æµ

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–ç®€ç§°
- `ndays`ï¼šæ—¶é—´å‘¨æœŸåˆ—è¡¨ï¼Œé»˜è®¤[3, 5, 10, 20]

**è¿”å›å­—æ®µ**ï¼š
- æ—¥æœŸä¸ºç´¢å¼•
- 1æ—¥ä¸»åŠ›å‡€æµå…¥ã€3æ—¥ä¸»åŠ›å‡€æµå…¥ã€5æ—¥ä¸»åŠ›å‡€æµå…¥ç­‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä½¿ç”¨é»˜è®¤å‘¨æœŸ
df = qs.stock_money('ä¸­å›½å¹³å®‰')

# è‡ªå®šä¹‰å‘¨æœŸ
df = qs.stock_money('ä¸­å›½å¹³å®‰', [10, 30, 60])
df.tail()
```

---

#### 2. åŒèŠ±é¡ºèµ„é‡‘æµæ•°æ®

**å‡½æ•°åç§°**ï¼š`ths_money(flag=None, n=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–åŒèŠ±é¡ºä¸ªè‚¡ã€è¡Œä¸šã€æ¦‚å¿µèµ„é‡‘æµæ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šæ•°æ®ç±»å‹
  - `'ä¸ªè‚¡'`ï¼šä¸ªè‚¡èµ„é‡‘æµ
  - `'æ¦‚å¿µ'`æˆ–`'æ¦‚å¿µæ¿å—'`ï¼šæ¦‚å¿µæ¿å—èµ„é‡‘æµ
  - `'è¡Œä¸š'`æˆ–`'è¡Œä¸šæ¿å—'`ï¼šè¡Œä¸šæ¿å—èµ„é‡‘æµ
- `n`ï¼šæ—¶é—´å‘¨æœŸ
  - `None`ï¼šå³æ—¶ï¼ˆé»˜è®¤ï¼‰
  - `1`ã€`3`ã€`5`ã€`10`ã€`20`ï¼šNæ—¥èµ„é‡‘æµæ’è¡Œ

**è¿”å›å­—æ®µ**ï¼š

**ä¸ªè‚¡å³æ—¶èµ„é‡‘æµ**ï¼š
- ä»£ç ã€ç®€ç§°ã€æœ€æ–°ä»·ã€æ¶¨å¹…ã€æ¢æ‰‹ç‡ã€æµå…¥èµ„é‡‘ã€æµå‡ºèµ„é‡‘ã€å‡€é¢(ä¸‡)ã€æˆäº¤é¢

**ä¸ªè‚¡Næ—¥èµ„é‡‘æµ**ï¼š
- ä»£ç ã€ç®€ç§°ã€æœ€æ–°ä»·ã€æ¶¨å¹…ã€æ¢æ‰‹ç‡ã€å‡€é¢(ä¸‡)

**è¡Œä¸š/æ¦‚å¿µå³æ—¶èµ„é‡‘æµ**ï¼š
- è¡Œä¸š/æ¦‚å¿µåç§°ã€å…¬å¸å®¶æ•°ã€è¡Œä¸š/æ¦‚å¿µæŒ‡æ•°ã€æ¶¨å¹…ã€å‡€é¢(äº¿)
- é¢†æ¶¨è‚¡ã€é¢†æ¶¨è‚¡æ¶¨å¹…ã€å½“å‰ä»·

**è¡Œä¸š/æ¦‚å¿µNæ—¥èµ„é‡‘æµ**ï¼š
- è¡Œä¸š/æ¦‚å¿µåç§°ã€å…¬å¸å®¶æ•°ã€è¡Œä¸š/æ¦‚å¿µæŒ‡æ•°ã€æ¶¨å¹…ã€å‡€é¢(äº¿)

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä¸ªè‚¡20æ—¥èµ„é‡‘æµæ•°æ®
df = qs.ths_money('ä¸ªè‚¡', n=20)

# è¡Œä¸šæ¿å—10æ—¥èµ„é‡‘æµæ•°æ®
df = qs.ths_money('è¡Œä¸š', n=10)

# æ¦‚å¿µæ¿å—5æ—¥èµ„é‡‘æµæ•°æ®
df = qs.ths_money('æ¦‚å¿µ', n=5)
```

---

#### 3. åŒ—å‘èµ„é‡‘

**å‡½æ•°åç§°**ï¼š`north_money(flag=None, n=1)`

**åŠŸèƒ½æè¿°**ï¼šè·å–åŒ—å‘èµ„é‡‘ï¼ˆæ²ªæ·±æ¸¯é€šï¼‰æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šæ•°æ®ç±»å‹
  - `None`ï¼šåŒ—å‘èµ„é‡‘æ€»ä½“æ¯æ—¥å‡€æµå…¥ï¼ˆé»˜è®¤ï¼‰
  - `'è¡Œä¸š'`ï¼šåŒ—å‘èµ„é‡‘å¢æŒè¡Œä¸šæ¿å—æ’è¡Œ
  - `'æ¦‚å¿µ'`ï¼šåŒ—å‘èµ„é‡‘å¢æŒæ¦‚å¿µæ¿å—æ’è¡Œ
  - `'ä¸ªè‚¡'`ï¼šåŒ—å‘èµ„é‡‘å¢æŒä¸ªè‚¡æƒ…å†µ
  - `'æ²ªè‚¡é€š'`ï¼šæ²ªè‚¡é€šèµ„é‡‘æµå‘
  - `'æ·±è‚¡é€š'`ï¼šæ·±è‚¡é€šèµ„é‡‘æµå‘
- `n`ï¼šæ—¶é—´å‘¨æœŸ
  - `1`ï¼š"ä»Šæ—¥"ï¼ˆé»˜è®¤ï¼‰
  - `3`ï¼š"3æ—¥"
  - `5`ï¼š"5æ—¥"
  - `10`ï¼š"10æ—¥"
  - `'M'`ï¼š"æœˆ"
  - `'Q'`ï¼š"å­£"
  - `'Y'`ï¼š"å¹´"

**è¿”å›å­—æ®µ**ï¼š

**åŒ—å‘èµ„é‡‘æ¯æ—¥å‡€æµå…¥**ï¼š
- æ—¥æœŸã€å‡€æµå…¥(äº¿)

**åŒ—å‘èµ„é‡‘å¢æŒä¸ªè‚¡**ï¼š
- ä»£ç ã€åç§°ã€æ”¶ç›˜ã€æ¶¨å¹…ã€æŒè‚¡æ•°ã€æŒè‚¡å¸‚å€¼ã€æŒè‚¡å æµé€šè‚¡æ¯”
- æŒè‚¡å æ€»è‚¡æœ¬æ¯”ã€Næ—¥å¢æŒè‚¡æ•°ã€Næ—¥å¢æŒå¸‚å€¼ã€Næ—¥å¢æŒå¸‚å€¼å¢å¹…
- Næ—¥å¢æŒå æµé€šè‚¡æ¯”ã€Næ—¥å¢æŒå æ€»è‚¡æœ¬æ¯”ã€æ‰€å±æ¿å—ã€æ—¥æœŸ

**åŒ—å‘èµ„é‡‘å¢æŒè¡Œä¸š/æ¦‚å¿µ**ï¼š
- æ—¥æœŸã€åç§°ã€æ¶¨è·Œå¹…ã€å¢æŒè‚¡ç¥¨åªæ•°ã€æŒæœ‰è‚¡ç¥¨åªæ•°ã€å¢æŒå¸‚å€¼
- å¢æŒå¸‚å€¼å¢å¹…ã€å¢æŒå æ¿å—æ¯”ã€å¢æŒå åŒ—å‘èµ„é‡‘æ¯”ã€æŒè‚¡å¸‚å€¼
- æŒè‚¡å åŒ—å‘èµ„é‡‘æ¯”ã€æŒè‚¡å æ¿å—æ¯”ã€å¢æŒæœ€å¤§è‚¡å¸‚å€¼ã€å‡æŒæœ€å¤§è‚¡å¸‚å€¼
- å¢æŒæœ€å¤§è‚¡å æ€»å¸‚å€¼æ¯”ã€å‡æŒæœ€å¤§è‚¡å æ€»å¸‚å€¼æ¯”

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# åŒ—å‘èµ„é‡‘æ¯æ—¥å‡€æµå…¥æ•°æ®
df = qs.north_money()
df.tail()

# åŒ—å‘èµ„é‡‘å¢æŒè¡Œä¸šæ¿å—5æ—¥æ’å
df = qs.north_money('è¡Œä¸š', 5)

# åŒ—å‘èµ„é‡‘å¢æŒæ¦‚å¿µæ¿å—
df = qs.north_money('æ¦‚å¿µ', 5)

# åŒ—å‘èµ„é‡‘å¢æŒä¸ªè‚¡æƒ…å†µ
df = qs.north_money('ä¸ªè‚¡', 5)
```

---

### è¡Œä¸šæ¦‚å¿µæ•°æ®

qstockæä¾›ä¸¤å¥—è¡Œä¸šæ¦‚å¿µæ•°æ®æ¥å£ï¼š**åŒèŠ±é¡º(ths)**å’Œ**ä¸œæ–¹è´¢å¯Œ(em)**

#### 1. åŒèŠ±é¡ºè¡Œä¸šæ¦‚å¿µæ•°æ®

##### 1.1 æ¿å—åç§°åˆ—è¡¨

**å‡½æ•°åç§°**ï¼š`ths_index_name(flag='æ¦‚å¿µ')`

**åŠŸèƒ½æè¿°**ï¼šè·å–åŒèŠ±é¡ºæ¦‚å¿µæˆ–è¡Œä¸šæ¿å—åç§°åˆ—è¡¨

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šæ¿å—ç±»å‹
  - `'æ¦‚å¿µ'`æˆ–`'æ¦‚å¿µæ¿å—'`ï¼šæ¦‚å¿µæ¿å—ï¼ˆé»˜è®¤ï¼‰
  - `'è¡Œä¸š'`æˆ–`'è¡Œä¸šæ¿å—'`ï¼šè¡Œä¸šæ¿å—

**è¿”å›**ï¼šæ¿å—åç§°åˆ—è¡¨

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è¡Œä¸šæ¿å—åç§°
name_list = qs.ths_index_name('è¡Œä¸š')
name_list[:5]

# æ¦‚å¿µæ¿å—åç§°
name_list = qs.ths_index_name('æ¦‚å¿µ')
name_list[:5]
```

##### 1.2 æ¿å—æˆåˆ†è‚¡

**å‡½æ•°åç§°**ï¼š`ths_index_member(code)`

**åŠŸèƒ½æè¿°**ï¼šè·å–åŒèŠ±é¡ºæ¦‚å¿µæˆ–è¡Œä¸šæ¿å—æˆåˆ†è‚¡

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šæ¿å—ä»£ç æˆ–ç®€ç§°
  - è¡Œä¸šç¤ºä¾‹ï¼š'ç§æ¤ä¸šä¸æ—ä¸š'ã€'881101'
  - æ¦‚å¿µç¤ºä¾‹ï¼š'æœ‰æœºç¡…æ¦‚å¿µ'ã€'ç™½é…’æ¦‚å¿µ'

**è¿”å›å­—æ®µ**ï¼š
- åºå·ã€è‚¡ç¥¨ä»£ç ã€è‚¡ç¥¨ç®€ç§°ã€æœ€æ–°ä»·ã€æ¶¨è·Œå¹…ã€æ¶¨é€Ÿã€æ¢æ‰‹ç‡ã€é‡æ¯”
- æŒ¯å¹…ã€æˆäº¤é¢ã€æµé€šè‚¡ã€æµé€šå¸‚å€¼ã€å¸‚ç›ˆç‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è¡Œä¸šæ¿å—æˆåˆ†è‚¡
df = qs.ths_index_member('ç§æ¤ä¸šä¸æ—ä¸š')

# æ¦‚å¿µæ¿å—æˆåˆ†è‚¡
df = qs.ths_index_member('æœ‰æœºç¡…æ¦‚å¿µ')
```

**æ³¨æ„äº‹é¡¹**ï¼š
- åŒèŠ±é¡ºæ•°æ®æ¥å£ä¸å¤ªç¨³å®šï¼Œå¦‚æŠ¥é”™è¯·è¿‡ä¸€æ®µæ—¶é—´å†è¯•
- ç›®å‰ä»…èƒ½è·å–ç¬¬ä¸€é¡µæ•°æ®

##### 1.3 æ¿å—æŒ‡æ•°è¡Œæƒ…

**å‡½æ•°åç§°**ï¼š`ths_index_data(code, start='2020', end=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–åŒèŠ±é¡ºæ¦‚å¿µæˆ–è¡Œä¸šæ¿å—æŒ‡æ•°å†å²è¡Œæƒ…æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šæ¿å—ä»£ç æˆ–ç®€ç§°
- `start`ï¼šèµ·å§‹å¹´ä»½ï¼Œé»˜è®¤'2020'
- `end`ï¼šç»“æŸæ—¥æœŸï¼Œé»˜è®¤æœ€æ–°äº¤æ˜“æ—¥

**è¿”å›å­—æ®µ**ï¼š
- dateï¼ˆç´¢å¼•ï¼‰ã€openã€highã€lowã€closeã€volume

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è¡Œä¸šæ¿å—æŒ‡æ•°
df = qs.ths_index_data('åŠå¯¼ä½“åŠå…ƒä»¶', start='20200101')

# æ¦‚å¿µæ¿å—æŒ‡æ•°
df = qs.ths_index_data('æœ‰æœºç¡…æ¦‚å¿µ', start='2020')
df.head()
```

---

#### 2. ä¸œæ–¹è´¢å¯Œè¡Œä¸šæ¦‚å¿µæ•°æ®

##### 2.1 æ¿å—åç§°åˆ—è¡¨

**å‡½æ•°åç§°**ï¼š`em_index_name(sector_type='concept')`

**åŠŸèƒ½æè¿°**ï¼šè·å–ä¸œæ–¹è´¢å¯Œè¡Œä¸šæˆ–æ¦‚å¿µæ¿å—åç§°åˆ—è¡¨åŠå®æ—¶è¡Œæƒ…

**å‚æ•°è¯´æ˜**ï¼š
- `sector_type`ï¼šæ¿å—ç±»å‹
  - `'concept'`æˆ–`'æ¦‚å¿µ'`ï¼šæ¦‚å¿µæ¿å—ï¼ˆé»˜è®¤ï¼‰
  - `'industry'`æˆ–`'è¡Œä¸š'`ï¼šè¡Œä¸šæ¿å—

**è¿”å›å­—æ®µ**ï¼š
- æ’åã€æ¿å—åç§°ã€æ¿å—ä»£ç ã€æœ€æ–°ä»·ã€æ¶¨è·Œé¢ã€æ¶¨è·Œå¹…
- æ€»å¸‚å€¼ã€æ¢æ‰‹ç‡ã€ä¸Šæ¶¨å®¶æ•°ã€ä¸‹è·Œå®¶æ•°ã€é¢†æ¶¨è‚¡ç¥¨ã€é¢†æ¶¨è‚¡ç¥¨æ¶¨è·Œå¹…

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è·å–æ¦‚å¿µæ¿å—
df = qs.em_index_name('concept')

# è·å–è¡Œä¸šæ¿å—
df = qs.em_index_name('industry')
```

##### 2.2 æ¿å—æˆåˆ†è‚¡

**å‡½æ•°åç§°**ï¼š`em_index_member(name)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ¿å—æˆåˆ†è‚¡

**å‚æ•°è¯´æ˜**ï¼š
- `name`ï¼šæ¿å—åç§°æˆ–æ¿å—ä»£ç ï¼ˆå¦‚'BK0679'ï¼‰

**è¿”å›å­—æ®µ**ï¼š
- åºå·ã€ä»£ç ã€åç§°ã€æœ€æ–°ä»·ã€æ¶¨è·Œå¹…ã€æ¶¨è·Œé¢ã€æˆäº¤é‡ã€æˆäº¤é¢
- æŒ¯å¹…ã€æœ€é«˜ã€æœ€ä½ã€ä»Šå¼€ã€æ˜¨æ”¶ã€æ¢æ‰‹ç‡ã€å¸‚ç›ˆç‡-åŠ¨æ€ã€å¸‚å‡€ç‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.em_index_member('é”‚ç”µæ± ')
```

##### 2.3 æ¿å—å®æ—¶è¡Œæƒ…

**å‡½æ•°åç§°**ï¼š`em_index_realtime(name)`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ¿å—å®æ—¶è¡Œæƒ…

**å‚æ•°è¯´æ˜**ï¼š
- `name`ï¼šæ¿å—åç§°æˆ–ä»£ç 

**è¿”å›å­—æ®µ**ï¼š
- æœ€æ–°ä»·ã€æœ€é«˜ã€æœ€ä½ã€å¼€ç›˜ã€æˆäº¤é‡ã€æˆäº¤é¢ã€æ¶¨è·Œå¹…ã€æŒ¯å¹…ã€æ¢æ‰‹ç‡ã€æ¶¨è·Œé¢

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.em_index_realtime('é”‚ç”µæ± ')
```

##### 2.4 æ¿å—å†å²è¡Œæƒ…

**å‡½æ•°åç§°**ï¼š`em_index_data(name, freq='d', start=None, end=None, fqt='')`

**åŠŸèƒ½æè¿°**ï¼šè·å–æ¿å—å†å²è¡Œæƒ…æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `name`ï¼šæ¿å—åç§°æˆ–ä»£ç 
- `freq`ï¼šå‘¨æœŸï¼Œ`'d'`(æ—¥)ã€`'w'`(å‘¨)ã€`'m'`(æœˆ)
- `start`ï¼šèµ·å§‹æ—¥æœŸï¼Œæ ¼å¼'YYYYMMDD'
- `end`ï¼šç»“æŸæ—¥æœŸï¼Œæ ¼å¼'YYYYMMDD'
- `fqt`ï¼šå¤æƒç±»å‹ï¼Œ`''`(ä¸å¤æƒ)ã€`'qfq'`(å‰å¤æƒ)ã€`'hfq'`(åå¤æƒ)

**è¿”å›å­—æ®µ**ï¼š
- æ—¥æœŸã€å¼€ç›˜ã€æ”¶ç›˜ã€æœ€é«˜ã€æœ€ä½ã€æ¶¨è·Œå¹…ã€æ¶¨è·Œé¢ã€æˆäº¤é‡ã€æˆäº¤é¢ã€æŒ¯å¹…ã€æ¢æ‰‹ç‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.em_index_data('é”‚ç”µæ± ', freq='d', start='20200101')
```

---

### å®è§‚ç»æµæ•°æ®

#### 1. å®è§‚ç»æµæŒ‡æ ‡

**å‡½æ•°åç§°**ï¼š`macro_data(flag=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å®è§‚ç»æµå¸¸è§æŒ‡æ ‡

**å‚æ•°è¯´æ˜**ï¼š
- `flag`ï¼šæŒ‡æ ‡ç±»å‹
  - `None`ï¼šGDPæ•°æ®ï¼ˆé»˜è®¤ï¼‰
  - `'gdp'`ï¼šGDPæ•°æ®
  - `'cpi'`ï¼šæ¶ˆè´¹è€…ç‰©ä»·æŒ‡æ•°
  - `'ppi'`ï¼šå·¥ä¸šå“å‡ºå‚ä»·æ ¼æŒ‡æ•°
  - `'pmi'`ï¼šé‡‡è´­ç»ç†äººæŒ‡æ•°
  - `'ms'`ï¼šè´§å¸ä¾›åº”é‡
  - `'lpr'`ï¼šè´·æ¬¾åŸºå‡†åˆ©ç‡

**å„æŒ‡æ ‡è¿”å›å­—æ®µ**ï¼š

**GDP**ï¼š
- å­£åº¦ã€å›½å†…ç”Ÿäº§æ€»å€¼ã€ç¬¬ä¸€äº§ä¸šã€ç¬¬äºŒäº§ä¸šã€ç¬¬ä¸‰äº§ä¸š
- å›½å†…ç”Ÿäº§æ€»å€¼åŒæ¯”ã€ç¬¬ä¸€äº§ä¸šåŒæ¯”ã€ç¬¬äºŒäº§ä¸šåŒæ¯”ã€ç¬¬ä¸‰äº§ä¸šåŒæ¯”

**CPI**ï¼š
- æœˆä»½ã€å…¨å›½åŒæ¯”ã€å…¨å›½å½“æœˆã€å…¨å›½ç¯æ¯”ã€å…¨å›½ç´¯è®¡
- åŸå¸‚åŒæ¯”ã€åŸå¸‚å½“æœˆã€åŸå¸‚ç¯æ¯”ã€åŸå¸‚ç´¯è®¡
- å†œæ‘åŒæ¯”ã€å†œæ‘å½“æœˆã€å†œæ‘ç¯æ¯”ã€å†œæ‘ç´¯è®¡

**PPI**ï¼š
- æœˆä»½ã€å½“æœˆã€å½“æœˆåŒæ¯”ã€ç´¯è®¡

**PMI**ï¼š
- æœˆä»½ã€åˆ¶é€ ä¸šã€åˆ¶é€ ä¸šåŒæ¯”ã€éåˆ¶é€ ä¸šã€éåˆ¶é€ ä¸šåŒæ¯”

**è´§å¸ä¾›åº”é‡(MS)**ï¼š
- æœˆä»½ã€M2(äº¿å…ƒ)ã€M2åŒæ¯”ã€M2ç¯æ¯”
- M1(äº¿å…ƒ)ã€M1åŒæ¯”ã€M1ç¯æ¯”
- M0(äº¿å…ƒ)ã€M0åŒæ¯”ã€M0ç¯æ¯”

**LPR**ï¼š
- æ—¥æœŸã€1å¹´lprã€5å¹´lprã€çŸ­æœŸ(6ä¸ªæœˆè‡³1å¹´)ã€ä¸­é•¿æœŸ(5å¹´ä»¥ä¸Š)

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# GDPæ•°æ®
df = qs.macro_data('gdp')

# CPIç‰©ä»·æŒ‡æ•°
df = qs.macro_data('cpi')

# PPIå·¥ä¸šå“å‡ºå‚ä»·æ ¼æŒ‡æ•°
df = qs.macro_data('ppi')

# PMIé‡‡è´­ç»ç†äººæŒ‡æ•°
df = qs.macro_data('pmi')

# è´§å¸ä¾›åº”é‡
df = qs.macro_data('ms')

# è´·æ¬¾åŸºå‡†åˆ©ç‡
df = qs.macro_data('lpr')
```

**å¿«æ·å‡½æ•°**ï¼š
ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ï¼š`qs.gdp()`ã€`qs.cpi()`ã€`qs.ppi()`ã€`qs.pmi()`ã€`qs.ms()`ã€`qs.lpr()`

---

#### 2. åŒä¸šæ‹†å€Ÿåˆ©ç‡

**å‡½æ•°åç§°**ï¼š`ib_rate(market='sh', fc=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœºåˆ©ç‡æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `market`ï¼šåŒä¸šæ‹†å€Ÿå¸‚åœº
  - `'sh'`ï¼šä¸Šæµ·é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœºï¼ˆé»˜è®¤ï¼‰
  - `'ch'`ï¼šä¸­å›½é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
  - `'l'`ï¼šä¼¦æ•¦é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
  - `'eu'`ï¼šæ¬§æ´²é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
  - `'hk'`ï¼šé¦™æ¸¯é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
  - `'s'`ï¼šæ–°åŠ å¡é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
- `fc`ï¼šå¤–å¸å¸ç§ï¼ˆæŸäº›å¸‚åœºéœ€è¦ï¼‰
  - `'CNY'`ï¼šäººæ°‘å¸
  - `'GBP'`ï¼šè‹±é•‘
  - `'EUR'`ï¼šæ¬§å…ƒ
  - `'USD'`ï¼šç¾å…ƒ
  - `'HKD'`ï¼šæ¸¯å¸
  - `'SGD'`ï¼šæ˜Ÿå…ƒ/æ–°å…ƒ
  - `'JPY'`ï¼šæ—¥å…ƒ

**å„å¸‚åœºæ”¯æŒçš„å¸ç§å’ŒæœŸé™**ï¼š
- **ä¸Šæµ·(sh)**ï¼šäººæ°‘å¸ï¼ŒæœŸé™ï¼šéš”å¤œã€1å‘¨ã€2å‘¨ã€1æœˆã€3æœˆã€6æœˆã€9æœˆã€1å¹´
- **ä¸­å›½(ch)**ï¼šäººæ°‘å¸ï¼ŒæœŸé™ï¼šéš”å¤œã€1å‘¨ã€2å‘¨ã€3å‘¨ã€1æœˆã€2æœˆã€3æœˆã€4æœˆã€6æœˆã€9æœˆã€1å¹´
- **ä¼¦æ•¦(l)**ï¼šè‹±é•‘/ç¾å…ƒ/æ¬§å…ƒ/æ—¥å…ƒï¼ŒæœŸé™ï¼šéš”å¤œã€1å‘¨ã€1æœˆã€2æœˆã€3æœˆã€8æœˆ
- **æ¬§æ´²(eu)**ï¼šæ¬§å…ƒï¼ŒæœŸé™ï¼š1å‘¨ã€2å‘¨ã€3å‘¨ã€1æœˆ-11æœˆã€1å¹´
- **é¦™æ¸¯(hk)**ï¼šæ¸¯å¸/ç¾å…ƒ/äººæ°‘å¸ï¼ŒæœŸé™ï¼šéš”å¤œã€1å‘¨ã€2å‘¨ã€1æœˆ-11æœˆã€1å¹´
- **æ–°åŠ å¡(s)**ï¼šæ˜Ÿå…ƒ/ç¾å…ƒï¼ŒæœŸé™ï¼š1æœˆã€2æœˆã€3æœˆã€6æœˆã€9æœˆã€1å¹´

**è¿”å›å­—æ®µ**ï¼š
- æŠ¥å‘Šæ—¥ã€å„æœŸé™åˆ©ç‡åˆ—

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä¸Šæµ·é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœºï¼ˆé»˜è®¤äººæ°‘å¸ï¼‰
df = qs.ib_rate()

# ä¸­å›½é“¶è¡ŒåŒä¸šæ‹†å€Ÿå¸‚åœº
df = qs.ib_rate(market='ch')

# ä¼¦æ•¦å¸‚åœº-è‹±é•‘
df = qs.ib_rate(market='l', fc='GBP')

# ä¼¦æ•¦å¸‚åœº-ç¾å…ƒ
df = qs.ib_rate('l', 'USD')

# æ¬§æ´²å¸‚åœº-æ¬§å…ƒ
df = qs.ib_rate('eu')

# é¦™æ¸¯å¸‚åœº-ç¾å…ƒ
df = qs.ib_rate('hk', 'USD')

# é¦™æ¸¯å¸‚åœº-æ¸¯å¸
df = qs.ib_rate('hk', 'HKD')

# æ–°åŠ å¡å¸‚åœº-ç¾å…ƒ
df = qs.ib_rate('s', 'USD')
```

---

### æ–°é—»èµ„è®¯æ•°æ®

**å‡½æ•°åç§°**ï¼š`news_data(news_type=None, start=None, end=None, code=None)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å„ç±»æ–°é—»èµ„è®¯æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `news_type`ï¼šæ–°é—»ç±»å‹
  - `None`ï¼šè´¢è”ç¤¾ç”µæŠ¥æ–°é—»ï¼ˆé»˜è®¤ï¼‰
  - `'cctv'`æˆ–`'æ–°é—»è”æ’­'`ï¼šæ–°é—»è”æ’­æ–‡å­—ç¨¿
  - `'js'`æˆ–`'é‡‘åæ•°æ®'`ï¼šé‡‘åæ•°æ®å¸‚åœºå¿«è®¯
  - `'stock'`æˆ–`'ä¸ªè‚¡æ–°é—»'`æˆ–`'ä¸ªè‚¡'`ï¼šä¸ªè‚¡æ–°é—»
- `start`ï¼šèµ·å§‹æ—¥æœŸï¼Œæ ¼å¼'20220930'
- `end`ï¼šç»“æŸæ—¥æœŸï¼Œæ ¼å¼'20221001'
- `code`ï¼šè‚¡ç¥¨ä»£ç ï¼ˆå½“news_typeä¸ºä¸ªè‚¡æ–°é—»æ—¶ä½¿ç”¨ï¼‰

**è¿”å›å­—æ®µ**ï¼š

**è´¢è”ç¤¾ç”µæŠ¥**ï¼š
- æ ‡é¢˜ã€å†…å®¹ã€å‘å¸ƒæ—¶é—´ã€å‘å¸ƒæ—¥æœŸ

**é‡‘åæ•°æ®**ï¼š
- datetimeã€content

**æ–°é—»è”æ’­**ï¼š
- dateã€titleã€content

**ä¸ªè‚¡æ–°é—»**ï¼š
- dateã€codeã€titleã€contentã€url

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è´¢è”ç¤¾ç”µæŠ¥æ–°é—»ï¼ˆé»˜è®¤ï¼‰
df = qs.news_data()
df.tail()

# é‡‘åæ•°æ®å¸‚åœºå¿«è®¯
df = qs.news_data('js', start='20220930', end='20221001')

# æ–°é—»è”æ’­æ–‡å­—ç¨¿
df = qs.news_data('cctv', start='20221016', end='20221016')

# ä¸ªè‚¡æ–°é—»
df = qs.news_data('ä¸ªè‚¡', code='å¤©ç‘ä»ªå™¨')
```

**å¿«æ·å‡½æ•°**ï¼š
- `qs.news_cctv(start, end)`ï¼šè·å–æ–°é—»è”æ’­
- `qs.stock_news(code)`ï¼šè·å–ä¸ªè‚¡æ–°é—»

---

### é—®è´¢æ•°æ®

**å‡½æ•°åç§°**ï¼š`wencai(question)`

**åŠŸèƒ½æè¿°**ï¼šé€šè¿‡è‡ªç„¶è¯­è¨€æŸ¥è¯¢è‚¡ç¥¨æ•°æ®ï¼ˆéœ€è¦é…ç½®Node.jsç¯å¢ƒï¼‰

**å‚æ•°è¯´æ˜**ï¼š
- `question`ï¼šæŸ¥è¯¢æ¡ä»¶ï¼Œä¸åŒæ¡ä»¶ä½¿ç”¨"ï¼Œ"æˆ–"ï¼›"æˆ–ç©ºæ ¼åˆ†éš”

**ç¯å¢ƒè¦æ±‚**ï¼š
1. å®‰è£…å¹¶å‡çº§pywencaiï¼š`pip install --upgrade pywencai`
2. å®‰è£…Node.jsï¼šhttps://nodejs.org/
3. åœ¨Node.jså‘½ä»¤è¡Œä¸­è¿è¡Œï¼š`npm install jsdom`

**è¿”å›**ï¼šæ ¹æ®æŸ¥è¯¢æ¡ä»¶è¿”å›ç›¸åº”çš„DataFrame

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# å‡çº¿å¤šå¤´æ’åˆ—
df = qs.wencai('å‡çº¿å¤šå¤´æ’åˆ—')

# å¤šä¸ªæ¡ä»¶ç»„åˆ
df = qs.wencai('å¸‚ç›ˆç‡å°äº20ï¼Œå¸‚å‡€ç‡å°äº2ï¼ŒROEå¤§äº15%')

# æ¶¨åœæ¿
df = qs.wencai('ä»Šæ—¥æ¶¨åœ')
```

**æ³¨æ„äº‹é¡¹**ï¼š
- éœ€è¦æ­£ç¡®é…ç½®Node.jsç¯å¢ƒ
- é—®è´¢æ¥å£å¯èƒ½ä¸ç¨³å®šï¼Œå¦‚é‡é”™è¯¯è¯·é‡è¯•
- æŸ¥è¯¢è¯­å¥éœ€ç¬¦åˆé—®è´¢çš„è¯­æ³•è§„èŒƒ

---

## å¯è§†åŒ–æ¨¡å— (plot)

qstockæä¾›ä¸¤å¥—å¯è§†åŒ–å·¥å…·ï¼š**plotlyäº¤äº’å¼å›¾è¡¨**å’Œ**pyechartså›¾è¡¨**

### å¯¼å…¥å¯è§†åŒ–æ¨¡å—

```python
from qstock import plot
```

### Plotlyäº¤äº’å¼å›¾è¡¨

#### 1. æŠ˜çº¿å›¾

**å‡½æ•°åç§°**ï¼š`plot.line(data, x, y, title, color, line_group, facet_col, legend, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `data`ï¼šDataFrameæˆ–Seriesæ•°æ®
- `x`ï¼šxè½´æ•°æ®åˆ—å
- `y`ï¼šyè½´æ•°æ®åˆ—å
- `title`ï¼šå›¾è¡¨æ ‡é¢˜
- `color`ï¼šæŒ‰ç±»åˆ«ç€è‰²
- `line_group`ï¼šåˆ†ç»„
- `facet_col`ï¼šåˆ†é¢
- `legend`ï¼šæ˜¯å¦æ˜¾ç¤ºå›¾ä¾‹ï¼Œé»˜è®¤True
- `notebook`ï¼šæ˜¯å¦åœ¨notebookä¸­æ˜¾ç¤ºï¼Œé»˜è®¤True

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# å•æ¡æŠ˜çº¿å›¾
code = 'ä¸­å›½å¹³å®‰'
df = qs.get_data(code)
plot.line(df.close, title=code+'ä»·æ ¼èµ°åŠ¿')

# å¤šæ¡å¯¹æ¯”æŠ˜çº¿å›¾
df['ma20'] = df.close.rolling(20).mean()
plot.line(df[['close','ma20']], title='ä¸­å›½å¹³å®‰è‚¡ä»·ä¸20æ—¥å‡çº¿')

# ä¸ªè‚¡èµ„é‡‘æµ
plot.line(qs.stock_money('ä¸­å›½å¹³å®‰'), title='ä¸­å›½å¹³å®‰èµ„é‡‘æµ')

# å…¨çƒæŒ‡æ•°ç´¯è®¡æ¶¨å¹…
global_indexs = ['sh','cyb','æ’ç”ŸæŒ‡æ•°','é“ç¼æ–¯','æ ‡æ™®500','çº³æ–¯è¾¾å…‹']
index_data = qs.get_price(global_indexs, start='2012-01-01').dropna()
plot.line(index_data/index_data.iloc[0], title='å…¨çƒæŒ‡æ•°ç´¯è®¡æ¶¨å¹…(2012-2022)')
```

#### 2. æ•£ç‚¹å›¾

**å‡½æ•°åç§°**ï¼š`plot.scatter(data, x, y, title, color, size, trend, legend, marginal_x, marginal_y, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `color`ï¼šæŒ‰ç±»åˆ«ç€è‰²
- `size`ï¼šæŒ‰æ•°å€¼å¤§å°æ˜¾ç¤ºæ•£ç‚¹å¤§å°
- `trend`ï¼š`'ols'`æ·»åŠ å›å½’æ‹Ÿåˆçº¿
- `marginal_x`ï¼š`'violin'`æ·»åŠ å°æç´å›¾
- `marginal_y`ï¼š`'box'`æ·»åŠ ç®±çº¿å›¾

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
data = qs.get_data('æ™“ç¨‹ç§‘æŠ€')
plot.scatter(data, x='close', y='volume')

# å¸¦è¶‹åŠ¿çº¿å’Œè¾¹é™…åˆ†å¸ƒ
data['ret'] = data.close/data.close.shift(1) - 1
data['weight'] = data['ret'].abs()
plot.scatter(data, x='turnover_rate', y='close', size='weight', 
             trend='ols', marginal_x='histogram', marginal_y='box')
```

#### 3. æŸ±çŠ¶å›¾

**å‡½æ•°åç§°**ï¼š`plot.bar(data, x, y, title, color, legend, orientation, log_x, log_y, barmode, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `orientation`ï¼š`'h'`è¡¨ç¤ºæ¨ªå‘æŸ±çŠ¶å›¾
- `log_x`ã€`log_y`ï¼šæ˜¯å¦ä½¿ç”¨å¯¹æ•°åæ ‡
- `barmode`ï¼š`'group'`å¯¹æ¯”æ¡å½¢å›¾ï¼ˆé»˜è®¤ï¼‰ã€`'relative'`å †å 

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# å…¨çƒæŒ‡æ•°å¹´åº¦æ¶¨è·Œå¹…
data = index_data.copy().dropna()
rets = data/data.shift(1) - 1
rets = rets.to_period('Y')
rets = (rets.groupby(rets.index).apply(lambda x: ((1+x).cumprod()-1).iloc[-1])*100).round(2)
rets = rets.iloc[-1].sort_values(ascending=False)

title = 'å…¨çƒæŒ‡æ•°2022å¹´æ¶¨è·Œå¹…'
plot.bar(rets, title=title)
```

#### 4. é¥¼å›¾

**å‡½æ•°åç§°**ï¼š`plot.pie(data, x, y, color, title, legend, hole, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `x`ï¼šæ ‡ç­¾åˆ—
- `y`ï¼šæ•°å€¼åˆ—
- `hole`ï¼šæ•°å€¼0-1ï¼Œæ˜¾ç¤ºä¸­é—´ç©ºå¿ƒï¼ˆç¯å½¢å›¾ï¼‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä¸ªè‚¡ä¸»è¥ä¸šåŠ¡å æ¯”
code = 'æ™“ç¨‹ç§‘æŠ€'
df = qs.main_business(code)
df = df[(df['æŠ¥å‘ŠæœŸ']=='2022ä¸­æœŸ') & (df['åˆ†ç±»æ–¹å‘']=='æŒ‰äº§å“åˆ†')]
plot.pie(df.iloc[:-1], x='åˆ†ç±»', y='è¥ä¸šæ”¶å…¥(ä¸‡)', title=code+'ä¸»è¥ä¸šåŠ¡æ”¶å…¥')
```

#### 5. ç®±çº¿å›¾

**å‡½æ•°åç§°**ï¼š`plot.box(data, x, y, title, color, legend, orientation, log_x, log_y, boxmode, notebook)`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
index_list = ['ä¸Šè¯æŒ‡æ•°','åˆ›ä¸šæ¿æŒ‡','æ²ªæ·±300','é“ç¼æ–¯','æ ‡æ™®500','çº³æ–¯è¾¾å…‹']
data = qs.get_price(index_list)
plot.box(data.dropna())
```

#### 6. å°æç´å›¾

**å‡½æ•°åç§°**ï¼š`plot.violin(data, x, y, title, color, legend, orientation, log_x, log_y, box, points, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `box`ï¼šæ˜¯å¦æ˜¾ç¤ºç®±çº¿å›¾
- `points`ï¼šæ˜¯å¦æ˜¾ç¤ºæ•°æ®ç‚¹

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
dd = qs.get_data(index_list)
plot.violin(dd, x='name', y='close', color='name', box=True)
```

#### 7. ç›´æ–¹å›¾

**å‡½æ•°åç§°**ï¼š`plot.hist(data, x, y, title, color, legend, orientation, log_x, log_y, barmode, histnorm, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `histnorm`ï¼šæ ‡å‡†åŒ–æ–¹å¼
  - `1`ï¼š'percent'
  - `2`ï¼š'probability'
  - `3`ï¼š'density'
  - `4`ï¼š'probability density'

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
code = 'æ™“ç¨‹ç§‘æŠ€'
data = qs.get_data(code, fqt=2)
plot.hist(data, x='close', histnorm=3, title=code+'è‚¡ä»·ç›´æ–¹å›¾')
```

#### 8. ç»Ÿè®¡åˆ†å¸ƒå›¾

**å‡½æ•°åç§°**ï¼š`plot.hist_kde(data, x, y, kde, stat, figsize)`

**å‚æ•°è¯´æ˜**ï¼š
- `kde`ï¼šæ˜¯å¦æ·»åŠ æ ¸å¯†åº¦æ›²çº¿ï¼Œé»˜è®¤True
- `stat`ï¼šç»Ÿè®¡æ–¹å¼ï¼Œå¯é€‰'count'ã€'frequency'ã€'density'ã€'probability'

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
plot.hist_kde(data.close, stat='probability')
```

#### 9. æ ‘çŠ¶å›¾

**å‡½æ•°åç§°**ï¼š`plot.treemap(data, label, weight, value, color, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `data`ï¼šDataFrameæ•°æ®
- `label`ï¼šæ˜¾ç¤ºæ ‡ç­¾åˆ—è¡¨ï¼Œå¦‚`['åç§°']`
- `weight`ï¼šæƒé‡åˆ—å
- `value`ï¼šæ•°å€¼åˆ—å
- `color`ï¼šé¢œè‰²åˆ—è¡¨ï¼Œå¦‚`['Green', 'Red', '#8b0000']`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è¡Œä¸šæ¿å—æ¶¨è·Œå¹…æ ‘çŠ¶å›¾
data = qs.realtime_data('è¡Œä¸šæ¿å—')[['åç§°','æ¶¨å¹…']]
data['æƒé‡'] = abs(data['æ¶¨å¹…'])
data = data[data['æ¶¨å¹…']!=0]
params = {'data':data, 'label':['åç§°'], 'weight':'æƒé‡', 'value':'æ¶¨å¹…'}
plot.treemap(**params)
```

---

### PyEchartså›¾è¡¨

#### 1. Kçº¿å›¾

**å‡½æ•°åç§°**ï¼š`plot.kline(df, mas, mal, notebook, title)`

**å‚æ•°è¯´æ˜**ï¼š
- `df`ï¼šåŒ…å«'open','high','low','close','volume'åˆ—çš„DataFrame
- `mas`ï¼šçŸ­æœŸå‡çº¿ï¼Œé»˜è®¤5
- `mal`ï¼šé•¿æœŸå‡çº¿ï¼Œé»˜è®¤20
- `notebook`ï¼šæ˜¯å¦åœ¨notebookæ˜¾ç¤ºï¼Œé»˜è®¤True
- `title`ï¼šå›¾è¡¨æ ‡é¢˜

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# åœ¨notebookå‰æ·»åŠ ä»¥ä¸‹ä»£ç ï¼ˆå¦‚æœå›¾å½¢ä¸æ˜¾ç¤ºï¼‰
from pyecharts.globals import CurrentConfig, NotebookType
CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_NOTEBOOK

# è·å–æ•°æ®å¹¶ç»˜å›¾
df = qs.get_data('ä¸­å›½å¹³å®‰', start='2022-06-01', end='2022-10-20')
plot.kline(df)
```

#### 2. ä¿®æ­£Kçº¿å›¾ï¼ˆå¹³å‡Kçº¿å›¾ï¼‰

**å‡½æ•°åç§°**ï¼š`plot.HA_kline(df)`

**åŠŸèƒ½æè¿°**ï¼šç»˜åˆ¶Heikin-Ashiä¿®æ­£Kçº¿å›¾ï¼Œå¯å‡å°‘å¸‚åœºå™ªå£°

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
plot.HA_kline(df)
```

#### 3. æŸ±çŠ¶å›¾

**å‡½æ•°åç§°**ï¼š`plot.chart_bar(data, x, y, title, notebook, zoom)`

**å‚æ•°è¯´æ˜**ï¼š
- `data`ï¼šDataFrameæˆ–xã€yä¸ºlist
- `zoom`ï¼šæ˜¯å¦å¯ç”¨ç¼©æ”¾ï¼Œé»˜è®¤False

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
plot.chart_bar(rets, title=title, zoom=True)
```

**çºµå‘æŸ±çŠ¶å›¾**ï¼š`plot.chart_inv_bar(data, x, y, title, notebook, zoom)`

#### 4. é¥¼å›¾

**å‡½æ•°åç§°**ï¼š`plot.chart_pie(data, x, y, data_pair, title, notebook)`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
plot.chart_pie(data=df.iloc[:-1], x='åˆ†ç±»', y='è¥ä¸šæ”¶å…¥(ä¸‡)', 
               title=code+'ä¸»è¥ä¸šåŠ¡æ”¶å…¥')
```

#### 5. çƒ­åŠ›å›¾

**å‡½æ•°åç§°**ï¼š`plot.chart_heatmap(x, y, v, title, notebook)`

**å‚æ•°è¯´æ˜**ï¼š
- `x`ï¼šxè½´æ ‡ç­¾åˆ—è¡¨
- `y`ï¼šyè½´æ ‡ç­¾åˆ—è¡¨
- `v`ï¼šå€¼åˆ—è¡¨ï¼Œæ ¼å¼ï¼š`[[x_index, y_index, value], ...]`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä¸Šè¯æŒ‡æ•°æœˆåº¦æ”¶ç›Šç‡çƒ­åŠ›å›¾
sh0 = qs.get_data('ä¸Šè¯æŒ‡æ•°').close['2011':'2021']
sh = (sh0/sh0.shift(1)-1).to_period('M')
sh = sh.groupby(sh.index).apply(lambda x: ((((1+x).cumprod()-1).iloc[-1])*100).round(2))

x = [str(i) for i in range(2011,2022)]
y = [str(i)+'æœˆ' for i in range(1,13)]
v = [[i,j,sh[str(2011+i)+'-'+str(1+j)]] for i in range(11) for j in range(12)]
plot.chart_heatmap(x, y, v, title='ä¸Šè¯æŒ‡æ•°æœˆåº¦æ”¶ç›Šç‡')
```

#### 6. åœ°å›¾

**å‡½æ•°åç§°**ï¼š`plot.chart_map(data, x, y, data_pair, title, notebook)`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# åœ°åŸŸæ¿å—åœ°å›¾
df = qs.realtime_data('åœ°åŸŸ')
df['åç§°'] = df['åç§°'].apply(lambda s: s[:-2] if s.endswith('æ¿å—') else s)
plot.chart_map(df, x='åç§°', y='æœ€æ–°')
```

#### 7. è¯äº‘å›¾

**å‡½æ•°åç§°**ï¼š`plot.chart_wordcloud(c_data)`

**å‚æ•°è¯´æ˜**ï¼š
- `c_data`ï¼šè¯äº‘æ•°æ®ï¼Œæ ¼å¼ï¼š`[(word, count), ...]`

**è¾…åŠ©å‡½æ•°**ï¼š`plot.cloud_data(txt_list)`
- å°†æ–‡æœ¬è½¬æ¢ä¸ºè¯äº‘æ ¼å¼

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
import jieba

# è·å–æ–°é—»æ•°æ®
txt = qs.news_data('cctv', start='20221020', end='20221021')
txt_list = ''.join(list(txt.content.apply(lambda s: str(s))))

# å¤„ç†åˆ†è¯å¹¶è½¬ä¸ºè¯äº‘æ ¼å¼
c_data = plot.cloud_data(txt_list)

# ç”»è¯äº‘å›¾
plot.chart_wordcloud(c_data)
```

#### 8. Ichimokuäº‘å›¾

**å‡½æ•°åç§°**ï¼š`plot.plot_ichimoku(df, t, k, l, s)`

**å‚æ•°è¯´æ˜**ï¼š
- `df`ï¼šåŒ…å«'open','high','low','close','volume'åˆ—çš„DataFrameï¼Œç´¢å¼•ä¸ºæ—¶é—´
- `t`ï¼šè½¬æŠ˜çº¿è®¡ç®—å‘¨æœŸï¼Œé»˜è®¤9
- `k`ï¼šåŸºå‡†çº¿è®¡ç®—å‘¨æœŸï¼Œé»˜è®¤26
- `l`ï¼šæ»åè·¨åº¦è®¡ç®—å‘¨æœŸï¼Œé»˜è®¤30
- `s`ï¼šå‰å¯¼è·¨åº¦Bè®¡ç®—å‘¨æœŸï¼Œé»˜è®¤52

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
df = qs.get_data('ä¸°å…ƒè‚¡ä»½', start='2021-03-01')
plot.plot_ichimoku(df)
```

---

## é€‰è‚¡æ¨¡å— (stock)

é€‰è‚¡æ¨¡å—æä¾›æŠ€æœ¯å½¢æ€é€‰è‚¡å’Œç­–ç•¥é€‰è‚¡åŠŸèƒ½ã€‚**æ³¨æ„**ï¼šéƒ¨åˆ†é«˜çº§ç­–ç•¥é€‰è‚¡åŠŸèƒ½ä»…ä¾›çŸ¥è¯†æ˜Ÿçƒä¼šå‘˜ä½¿ç”¨ã€‚

### å¯¼å…¥é€‰è‚¡æ¨¡å—

```python
from qstock.stock import stock_pool
```

### å¯ç”¨é€‰è‚¡ç­–ç•¥

#### 1. RPSé€‰è‚¡

**ç±»å**ï¼š`RPS(data, w_list=[5,20,60,120,250])`

**åŠŸèƒ½æè¿°**ï¼šè®¡ç®—ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡ï¼ˆRelative Price Strengthï¼‰

**å‚æ•°è¯´æ˜**ï¼š
- `data`ï¼šå¤šåªè‚¡ç¥¨çš„ä»·æ ¼DataFrameï¼ˆå®½è¡¨æ ¼å¼ï¼‰
- `w_list`ï¼šè®¡ç®—å‘¨æœŸåˆ—è¡¨

**æ–¹æ³•**ï¼š
- `all_rps(w)`ï¼šè®¡ç®—æŒ‡å®šå‘¨æœŸçš„RPS
- `date_rps()`ï¼šä¼šå‘˜åŠŸèƒ½
- `plot_stock_rps(stock, n)`ï¼šä¼šå‘˜åŠŸèƒ½

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# è·å–å¤šåªè‚¡ç¥¨æ•°æ®
code_list = ['ä¸­å›½å¹³å®‰','è´µå·èŒ…å°','æ™“ç¨‹ç§‘æŠ€','ä¸œæ–¹è´¢å¯Œ','å®å¾·æ—¶ä»£']
data = qs.get_price(code_list, start='20200101')

# åˆ›å»ºRPSå¯¹è±¡
rps = stock_pool.RPS(data, w_list=[20,60,120,250])

# è®¡ç®—120æ—¥RPS
rps_120 = rps.all_rps(120)
print(rps_120.tail())
```

#### 2. é‡ä»·é€‰è‚¡

**å‡½æ•°åç§°**ï¼š`find_price_vol_stock(data, n, rr)`

**åŠŸèƒ½æè¿°**ï¼šç­›é€‰ä»·æ ¼å’Œæˆäº¤é‡çªç ´Næ—¥é˜ˆå€¼çš„ä¸ªè‚¡ï¼ˆå‚è€ƒæ¬§å¥ˆå°”å¸¦æŸ„èŒ¶æ¯å½¢æ€ï¼‰

**çŠ¶æ€**ï¼šä¼šå‘˜åŠŸèƒ½

#### 3. MMè¶‹åŠ¿é€‰è‚¡

**å‡½æ•°åç§°**ï¼š`MM_trend(close, sma, mma, lma)`

**åŠŸèƒ½æè¿°**ï¼šMark Minerviniè¶‹åŠ¿æ¨¡æ¿é€‰è‚¡æ³•

**çŠ¶æ€**ï¼šä¼šå‘˜åŠŸèƒ½

#### 4. èµ„é‡‘æµé€‰è‚¡

**å‡½æ•°åç§°**ï¼š`moneyflow_stock(codes, w_list)`

**åŠŸèƒ½æè¿°**ï¼šåŸºäºèµ„é‡‘æµå‘çš„é€‰è‚¡ç­–ç•¥

**çŠ¶æ€**ï¼šä¼šå‘˜åŠŸèƒ½

#### 5. è´¢åŠ¡æŒ‡æ ‡é€‰è‚¡

ç›¸å…³å‡½æ•°ï¼š
- `indicator_score(tudata, code, pepb, fields)`ï¼šè´¢åŠ¡æŒ‡æ ‡æ‰“åˆ†
- `all_indicator_score(tudata, name_code_dict)`ï¼šæ‰¹é‡æ‰“åˆ†
- `indicator_score_rank(df, n1, n2)`ï¼šæ’åç­›é€‰

**çŠ¶æ€**ï¼šä¼šå‘˜åŠŸèƒ½

---

## å›æµ‹æ¨¡å— (backtest)

å›æµ‹æ¨¡å—æä¾›å‘é‡åŒ–å›æµ‹å’Œäº‹ä»¶é©±åŠ¨å›æµ‹æ¡†æ¶ã€‚

### å‘é‡åŒ–å›æµ‹

**æ¨¡å—**ï¼š`qstock.backtest.vec_backtest`

#### ä¸»è¦å‡½æ•°

##### 1. æ•°æ®å‡†å¤‡

**å‡½æ•°åç§°**ï¼š`data_feed(code, index='hs300', start='20000101', end='', fqt=2)`

**åŠŸèƒ½æè¿°**ï¼šè·å–å¹¶å‡†å¤‡å›æµ‹æ•°æ®

**å‚æ•°è¯´æ˜**ï¼š
- `code`ï¼šè‚¡ç¥¨ä»£ç æˆ–åç§°
- `index`ï¼šå¯¹æ¯”æŒ‡æ•°ï¼Œé»˜è®¤'hs300'
- `start`ï¼šèµ·å§‹æ—¥æœŸ
- `end`ï¼šç»“æŸæ—¥æœŸ
- `fqt`ï¼šå¤æƒç±»å‹ï¼Œé»˜è®¤åå¤æƒ

**è¿”å›**ï¼šåŒ…å«ä¸ªè‚¡æ•°æ®ã€æŒ‡æ•°æ”¶ç›Šç‡ã€ä¸ªè‚¡æ”¶ç›Šç‡çš„DataFrame

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
from qstock.backtest.vec_backtest import *

# è·å–å›æµ‹æ•°æ®
df = data_feed('ä¸­å›½å¹³å®‰', index='hs300', start='20150101', fqt=2)
```

##### 2. ç­–ç•¥æŒ‡æ ‡è®¡ç®—

åœ¨`df`ä¸­æ·»åŠ è‡ªå®šä¹‰ç­–ç•¥ä¿¡å·åˆ—ï¼š
- `position`ï¼šæŒä»“æ¯”ä¾‹ï¼ˆ0-1ï¼‰
- `capital_ret`ï¼šç­–ç•¥æ”¶ç›Šç‡

**ç¤ºä¾‹**ï¼š

```python
# ç®€å•å‡çº¿ç­–ç•¥
df['ma5'] = df.close.rolling(5).mean()
df['ma20'] = df.close.rolling(20).mean()

# ç”Ÿæˆä¿¡å·ï¼šma5ä¸Šç©¿ma20ä¹°å…¥ï¼Œä¸‹ç©¿å–å‡º
df['signal'] = 0
df.loc[df['ma5'] > df['ma20'], 'signal'] = 1
df.loc[df['ma5'] <= df['ma20'], 'signal'] = 0

# æ ¹æ®ä¿¡å·ç”ŸæˆæŒä»“
df['position'] = df['signal']

# è®¡ç®—ç­–ç•¥æ”¶ç›Šç‡
df['capital_ret'] = df['position'].shift(1) * df['rets']
df['capital_ret'].fillna(0, inplace=True)
```

##### 3. ç»©æ•ˆåˆ†æ

**å‡½æ•°åç§°**ï¼š`trade_performance(df, plot=True)`

**åŠŸèƒ½æè¿°**ï¼šè®¡ç®—ç­–ç•¥ç»©æ•ˆæŒ‡æ ‡å¹¶ç»˜å›¾

**å‚æ•°è¯´æ˜**ï¼š
- `df`ï¼šåŒ…å«ç­–ç•¥æ•°æ®çš„DataFrame
- `plot`ï¼šæ˜¯å¦ç»˜åˆ¶æ”¶ç›Šæ›²çº¿å›¾ï¼Œé»˜è®¤True

**è¿”å›æŒ‡æ ‡**ï¼š
- æ€»æ”¶ç›Šç‡ã€å¹´åŒ–æ”¶ç›Šç‡ã€æœ€å¤§å›æ’¤ã€å¤æ™®æ¯”ç‡
- Alphaã€Betaç³»æ•°
- å¹´åº¦èƒœç‡ã€æœˆåº¦èƒœç‡ã€å‘¨åº¦èƒœç‡

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# åˆ†æç­–ç•¥è¡¨ç°
result = trade_performance(df, plot=True)
print(result)
```

##### 4. äº¤æ˜“æ˜ç»†

**å‡½æ•°åç§°**ï¼š`trade_indicators(df)`

**åŠŸèƒ½æè¿°**ï¼šè®¡ç®—æ¯ç¬”äº¤æ˜“çš„è¯¦ç»†ä¿¡æ¯

**è¿”å›æŒ‡æ ‡**ï¼š
- äº¤æ˜“æ¬¡æ•°ã€æœ€é•¿æŒæœ‰å¤©æ•°ã€æ¯æ¬¡å¹³å‡æ¶¨å¹…
- å•æ¬¡æœ€å¤§ç›ˆåˆ©ã€å•æ¬¡æœ€å¤§äºæŸ
- å¹´å‡ä¹°å–æ¬¡æ•°
- æœ€å¤§è¿ç»­ç›ˆåˆ©æ¬¡æ•°ã€æœ€å¤§è¿ç»­äºæŸæ¬¡æ•°

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# æŸ¥çœ‹äº¤æ˜“æ˜ç»†
trade = trade_indicators(df)
print(trade)
```

---

### äº‹ä»¶é©±åŠ¨å›æµ‹

**æ¨¡å—**ï¼š`qstock.backtest.bt_backtest`

**çŠ¶æ€**ï¼šé«˜çº§åŠŸèƒ½ï¼Œå»ºè®®æŸ¥çœ‹æºç å­¦ä¹ 

**ç‰¹ç‚¹**ï¼š
- åŸºäºbacktraderæ¡†æ¶
- æ”¯æŒå¤æ‚ç­–ç•¥å›æµ‹
- æ”¯æŒå¤šæ ‡çš„ã€å¤šç­–ç•¥
- æä¾›è¯¦ç»†çš„äº¤æ˜“è®°å½•

---

## å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹

### æ•°æ®è·å–ç›¸å…³

1. **è·å–ä¸åˆ°æ•°æ®æˆ–æŠ¥é”™**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - æ•°æ®æºç½‘ç«™å¯èƒ½ä¸´æ—¶ç»´æŠ¤
   - åŒèŠ±é¡ºæ¥å£ä¸ç¨³å®šï¼Œå»ºè®®ä½¿ç”¨ä¸œæ–¹è´¢å¯Œæ¥å£
   - è¿‡ä¸€æ®µæ—¶é—´å†è¯•

2. **1åˆ†é’Ÿæ•°æ®é™åˆ¶**
   - 1åˆ†é’ŸKçº¿æ•°æ®ä»…èƒ½è·å–æœ€è¿‘5ä¸ªäº¤æ˜“æ—¥

3. **æŒ‡æ•°æ•°æ®è·å–**
   - æŒ‡æ•°ä»£ç éœ€ä½¿ç”¨ç®€ç§°æˆ–æ‹¼éŸ³ç¼©å†™
   - é¿å…ä¸è‚¡ç¥¨ä»£ç å†²çªï¼Œå¦‚'000001'æ—¢æ˜¯å¹³å®‰é“¶è¡Œä¹Ÿæ˜¯ä¸Šè¯æŒ‡æ•°
   - ä½¿ç”¨'sh'ä»£è¡¨ä¸Šè¯æŒ‡æ•°ï¼Œ'sz'ä»£è¡¨æ·±è¯æˆæŒ‡

4. **å¤æƒæ•°æ®é€‰æ‹©**
   - åˆ†æä»·æ ¼è¶‹åŠ¿ï¼šä½¿ç”¨å‰å¤æƒï¼ˆfqt=1ï¼‰
   - å›æµ‹ç­–ç•¥ï¼šä½¿ç”¨åå¤æƒï¼ˆfqt=2ï¼‰
   - æŸ¥çœ‹çœŸå®ä»·æ ¼ï¼šä¸å¤æƒï¼ˆfqt=0ï¼‰

### é—®è´¢åŠŸèƒ½ç›¸å…³

1. **é—®è´¢åŠŸèƒ½é…ç½®**
   - å¿…é¡»å®‰è£…Node.jså¹¶é…ç½®jsdom
   - å‡çº§pywencaiåˆ°æœ€æ–°ç‰ˆæœ¬
   - æŸ¥è¯¢è¯­å¥è¦ç¬¦åˆé—®è´¢è¯­æ³•

2. **é—®è´¢æ¥å£ä¸ç¨³å®š**
   - å¦‚é‡é”™è¯¯å¤šé‡è¯•å‡ æ¬¡
   - é¿å…é¢‘ç¹è°ƒç”¨

### å¯è§†åŒ–ç›¸å…³

1. **Jupyter Notebookä¸æ˜¾ç¤ºå›¾è¡¨**
   ```python
   from pyecharts.globals import CurrentConfig, NotebookType
   CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_NOTEBOOK
   ```

2. **å›¾è¡¨è¾“å‡ºåˆ°HTMLæ–‡ä»¶**
   - è®¾ç½®`notebook=False`å‚æ•°
   - ä¼šç”ŸæˆHTMLæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°

### æ€§èƒ½ä¼˜åŒ–

1. **æ‰¹é‡è·å–æ•°æ®**
   - ä½¿ç”¨åˆ—è¡¨å½¢å¼ä¸€æ¬¡æ€§è·å–å¤šåªè‚¡ç¥¨æ•°æ®
   - é¿å…åœ¨å¾ªç¯ä¸­é¢‘ç¹è°ƒç”¨æ¥å£

2. **æ•°æ®ç¼“å­˜**
   - å¯¹äºä¸å˜çš„å†å²æ•°æ®ï¼Œå»ºè®®ç¼“å­˜åˆ°æœ¬åœ°
   - å‡å°‘é‡å¤è¯·æ±‚

3. **å¤šçº¿ç¨‹å¤„ç†**
   - qstockå†…éƒ¨å·²ä½¿ç”¨å¤šçº¿ç¨‹åŠ é€Ÿ
   - ç”¨æˆ·æ— éœ€é¢å¤–å¤„ç†

### ç‰ˆæœ¬æ›´æ–°

**æŸ¥çœ‹å½“å‰ç‰ˆæœ¬**ï¼š
```python
import qstock
print(qstock.__version__)
```

**æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬**ï¼š
```bash
pip install --upgrade qstock
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šè·å–è‚¡ç¥¨æ•°æ®å¹¶å¯è§†åŒ–

```python
import qstock as qs
from qstock import plot

# è·å–è‚¡ç¥¨å†å²æ•°æ®
df = qs.get_data('ä¸­å›½å¹³å®‰', start='20220101')

# è®¡ç®—å‡çº¿
df['ma5'] = df.close.rolling(5).mean()
df['ma20'] = df.close.rolling(20).mean()

# ç»˜åˆ¶Kçº¿å›¾
plot.kline(df, mas=5, mal=20)

# ç»˜åˆ¶æŠ˜çº¿å›¾
plot.line(df[['close','ma5','ma20']], title='ä¸­å›½å¹³å®‰ä»·æ ¼èµ°åŠ¿')
```

### ç¤ºä¾‹2ï¼šåˆ†æèµ„é‡‘æµå‘

```python
import qstock as qs
from qstock import plot

# è·å–ä¸ªè‚¡èµ„é‡‘æµ
df = qs.stock_money('ä¸­å›½å¹³å®‰', ndays=[5, 10, 20, 60])
print(df.tail())

# å¯è§†åŒ–
plot.line(df, title='ä¸­å›½å¹³å®‰èµ„é‡‘æµå‘')

# è·å–åŒ—å‘èµ„é‡‘
north = qs.north_money()
plot.line(north, title='åŒ—å‘èµ„é‡‘æµå‘')
```

### ç¤ºä¾‹3ï¼šè¡Œä¸šæ¦‚å¿µåˆ†æ

```python
import qstock as qs

# è·å–è¡Œä¸šæ¿å—åˆ—è¡¨
industry_df = qs.em_index_name('è¡Œä¸š')
print(industry_df.head())

# è·å–æ¦‚å¿µæ¿å—æˆåˆ†è‚¡
concept_stocks = qs.em_index_member('é”‚ç”µæ± ')
print(concept_stocks.head())

# è·å–æ¿å—å†å²æ•°æ®
df = qs.em_index_data('é”‚ç”µæ± ', start='20200101')
print(df.tail())
```

### ç¤ºä¾‹4ï¼šåŸºæœ¬é¢ç­›é€‰

```python
import qstock as qs

# è·å–æœ€æ–°ä¸šç»©æŠ¥è¡¨
df = qs.financial_statement('ä¸šç»©æŠ¥è¡¨')

# ç­›é€‰æ¡ä»¶ï¼š
# 1. ROE > 15%
# 2. å‡€åˆ©æ¶¦åŒæ¯” > 20%
# 3. è¥æ”¶åŒæ¯” > 10%
filtered = df[(df['å‡€èµ„äº§æ”¶ç›Šç‡'] > 15) & 
              (df['å‡€åˆ©æ¶¦åŒæ¯”'] > 20) & 
              (df['è¥ä¸šæ”¶å…¥åŒæ¯”'] > 10)]

print(filtered[['ä»£ç ','ç®€ç§°','å‡€èµ„äº§æ”¶ç›Šç‡','å‡€åˆ©æ¶¦åŒæ¯”','è¥ä¸šæ”¶å…¥åŒæ¯”']])
```

### ç¤ºä¾‹5ï¼šç®€å•å‡çº¿ç­–ç•¥å›æµ‹

```python
import qstock as qs
from qstock.backtest.vec_backtest import *

# 1. è·å–æ•°æ®
df = data_feed('300139', index='cyb', start='20150101', fqt=2)

# 2. è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
df['ma5'] = df.close.rolling(5).mean()
df['ma20'] = df.close.rolling(20).mean()

# 3. ç”Ÿæˆäº¤æ˜“ä¿¡å·
df['position'] = 0  # æŒä»“æ¯”ä¾‹
df.loc[df['ma5'] > df['ma20'], 'position'] = 1  # é‡‘å‰ä¹°å…¥
df.loc[df['ma5'] <= df['ma20'], 'position'] = 0  # æ­»å‰å–å‡º

# 4. è®¡ç®—ç­–ç•¥æ”¶ç›Š
df['capital_ret'] = df['position'].shift(1) * df['rets']
df['capital_ret'].fillna(0, inplace=True)

# 5. ç»©æ•ˆåˆ†æ
result = trade_performance(df, plot=True)
print('\nç­–ç•¥ç»©æ•ˆæŒ‡æ ‡ï¼š')
print(result)

# 6. äº¤æ˜“æ˜ç»†
trade = trade_indicators(df)
```

### ç¤ºä¾‹6ï¼šå®æ—¶ç›¯ç›˜

```python
import qstock as qs
import time

def monitor_market():
    """å®æ—¶ç›‘æ§å¸‚åœºå¼‚åŠ¨"""
    while True:
        try:
            # è·å–ç›˜å£å¼‚åŠ¨
            df_rocket = qs.realtime_change('ç«ç®­å‘å°„')
            df_limit_up = qs.realtime_change('å°æ¶¨åœæ¿')
            df_new_high = qs.realtime_change('60æ—¥æ–°é«˜')
            
            print(f'\n=== {time.strftime("%H:%M:%S")} å¸‚åœºå¼‚åŠ¨ ===')
            
            if len(df_rocket) > 0:
                print(f'\nç«ç®­å‘å°„: {len(df_rocket)}åª')
                print(df_rocket[['ä»£ç ','åç§°','ç›¸å…³ä¿¡æ¯']].head())
            
            if len(df_limit_up) > 0:
                print(f'\nå°æ¶¨åœæ¿: {len(df_limit_up)}åª')
                print(df_limit_up[['ä»£ç ','åç§°']].head())
            
            if len(df_new_high) > 0:
                print(f'\n60æ—¥æ–°é«˜: {len(df_new_high)}åª')
                print(df_new_high[['ä»£ç ','åç§°']].head())
            
            # æ¯30ç§’åˆ·æ–°ä¸€æ¬¡
            time.sleep(30)
            
        except KeyboardInterrupt:
            print('\nç›‘æ§ç»“æŸ')
            break
        except Exception as e:
            print(f'Error: {e}')
            time.sleep(30)

# åœ¨äº¤æ˜“æ—¶é—´è¿è¡Œ
# monitor_market()
```

### ç¤ºä¾‹7ï¼šå¤šå› å­é€‰è‚¡

```python
import qstock as qs
import pandas as pd

# 1. è·å–å…¨å¸‚åœºè‚¡ç¥¨åˆ—è¡¨
all_stocks = qs.realtime_data('æ²ªæ·±A')
code_list = all_stocks['ä»£ç '].tolist()[:100]  # é™åˆ¶æ•°é‡ä»¥åŠ å¿«é€Ÿåº¦

# 2. è·å–åŸºæœ¬é¢æŒ‡æ ‡
df = qs.stock_basics(code_list)

# 3. å¤šå› å­ç­›é€‰
# å› å­1ï¼šROE > 15
# å› å­2ï¼šå¸‚ç›ˆç‡ < 30
# å› å­3ï¼šå¸‚å‡€ç‡ < 3
# å› å­4ï¼šæ¯›åˆ©ç‡ > 30

filtered = df[(df['ROE'] > 15) & 
              (df['å¸‚ç›ˆç‡'] < 30) & 
              (df['å¸‚å‡€ç‡'] < 3) & 
              (df['æ¯›åˆ©ç‡'] > 30)]

filtered = filtered.sort_values('ROE', ascending=False)

print('\nå¤šå› å­é€‰è‚¡ç»“æœï¼š')
print(filtered[['ä»£ç ','åç§°','ROE','å¸‚ç›ˆç‡','å¸‚å‡€ç‡','æ¯›åˆ©ç‡']])

# 4. è¿›ä¸€æ­¥åˆ†æèµ„é‡‘æµå‘
for code in filtered['ä»£ç '][:5]:  # å–å‰5åª
    try:
        money = qs.stock_money(code, [5, 10, 20])
        print(f'\n{code} èµ„é‡‘æµå‘ï¼š')
        print(money.tail(1))
    except:
        continue
```

### ç¤ºä¾‹8ï¼šæ¿å—è½®åŠ¨åˆ†æ

```python
import qstock as qs
from qstock import plot
import pandas as pd

# 1. è·å–è¡Œä¸šæ¿å—æ•°æ®
industry_list = qs.ths_index_name('è¡Œä¸š')[:10]  # å–å‰10ä¸ªè¡Œä¸š

# 2. è·å–æ¿å—å†å²æ•°æ®
price_data = {}
for industry in industry_list:
    try:
        df = qs.ths_index_data(industry, start='20220101')
        price_data[industry] = df['close']
    except:
        continue

# 3. åˆå¹¶æ•°æ®
df = pd.DataFrame(price_data)

# 4. è®¡ç®—æ”¶ç›Šç‡
returns = df.pct_change()

# 5. è®¡ç®—åŠ¨é‡ï¼ˆè¿‘20æ—¥ç´¯è®¡æ”¶ç›Šï¼‰
momentum = returns.rolling(20).sum() * 100

# 6. å¯è§†åŒ–
plot.line(momentum, title='è¡Œä¸šæ¿å—åŠ¨é‡(20æ—¥)')

# 7. æ‰¾å‡ºå¼ºåŠ¿æ¿å—
latest_momentum = momentum.iloc[-1].sort_values(ascending=False)
print('\nå½“å‰å¼ºåŠ¿è¡Œä¸šæ¿å—TOP5ï¼š')
print(latest_momentum.head())
```

---

## è¿›é˜¶å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£

- **PyPIä¸»é¡µ**ï¼šhttps://pypi.org/project/qstock/
- **å…¬ä¼—å·**ï¼š"Pythoné‡‘èé‡åŒ–"
- **çŸ¥è¯†æ˜Ÿçƒ**ï¼šé«˜çº§åŠŸèƒ½å’Œç­–ç•¥ï¼ˆä»˜è´¹ï¼‰

### ç³»åˆ—æ–‡ç« 

å…¬ä¼—å·"Pythoné‡‘èé‡åŒ–"qstockä¸“é¢˜ç³»åˆ—ï¼š
1. ã€qstockå¼€æºäº†ã€‘æ•°æ®ç¯‡ä¹‹è¡Œæƒ…äº¤æ˜“æ•°æ®
2. ã€qstockæ•°æ®ç¯‡ã€‘è¡Œä¸šæ¦‚å¿µæ¿å—ä¸èµ„é‡‘æµ
3. ã€qstocké‡åŒ–ã€‘æ•°æ®ç¯‡ä¹‹è‚¡ç¥¨åŸºæœ¬é¢æ•°æ®
4. ã€qstocké‡åŒ–ã€‘æ•°æ®ç¯‡ä¹‹å®è§‚æŒ‡æ ‡å’Œè´¢ç»æ–°é—»æ–‡æœ¬
5. ã€qstocké‡åŒ–ã€‘åŠ¨æ€äº¤äº’æ•°æ®å¯è§†åŒ–
6. ã€qstocké‡åŒ–ã€‘æŠ€æœ¯å½¢æ€ä¸æ¦‚å¿µçƒ­ç‚¹é€‰è‚¡æ± 
7. ã€æ‰‹æŠŠæ‰‹æ•™ä½ ã€‘ä½¿ç”¨qstockå®ç°é‡åŒ–ç­–ç•¥é€‰è‚¡
8. ã€æ‰‹æŠŠæ‰‹æ•™ä½ ã€‘ä½¿ç”¨qstockè¿›è¡Œé‡åŒ–å›æµ‹
9. åŸºäºqstockçš„é‡åŒ–å¤ç›˜ä¸è‡ªåŠ¨ç›¯ç›˜

### ç¤¾åŒºæ”¯æŒ

- **ä¸ªäººå¾®ä¿¡**ï¼šsky2blue2ï¼ˆçŸ¥è¯†æ˜Ÿçƒ8æŠ˜ä¼˜æƒ ï¼‰
- **GitHub Issues**ï¼šæŠ¥å‘Šbugå’ŒåŠŸèƒ½å»ºè®®

---

## å…è´£å£°æ˜

1. qstockæ˜¯**å¼€æºå…è´¹**çš„é‡åŒ–å·¥å…·åº“ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨
2. æ•°æ®æ¥è‡ªå…¬å¼€ç½‘ç»œæ•°æ®æºï¼Œ**ä¸ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§**
3. **æŠ•èµ„æœ‰é£é™©**ï¼Œä½¿ç”¨æœ¬åº“è¿›è¡ŒæŠ•èµ„å†³ç­–é€ æˆçš„ä»»ä½•æŸå¤±ï¼Œå¼€å‘è€…ä¸æ‰¿æ‹…è´£ä»»
4. è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œ**ä¸è¦ç”¨äºå•†ä¸šç”¨é€”**
5. éƒ¨åˆ†é«˜çº§åŠŸèƒ½éœ€è¦çŸ¥è¯†æ˜Ÿçƒä¼šå‘˜æƒé™

---

## è”ç³»æ–¹å¼

- **å…¬ä¼—å·**ï¼šPythoné‡‘èé‡åŒ–
- **ä¸ªäººå¾®ä¿¡**ï¼šsky2blue2
- **çŸ¥è¯†æ˜Ÿçƒ**ï¼šè¯¦è§å…¬ä¼—å·ç½®é¡¶

---

**ç¥ä½ åœ¨é‡åŒ–æŠ•èµ„çš„é“è·¯ä¸Šè¶Šèµ°è¶Šè¿œï¼**

---

*æœ€åæ›´æ–°æ—¶é—´ï¼š2024å¹´12æœˆ*
*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*
*å¯¹åº”qstockç‰ˆæœ¬ï¼š1.3.8*

